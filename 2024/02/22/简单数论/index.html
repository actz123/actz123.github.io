<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>简单数论 | Actz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/css/highlight.css">

  
  <meta name="description" content="简单数论1 模运算 定义：模运算为 a 除以 m 的余数，记为 a mod m，有 a mod m &#x3D; a % m。 模运算是大数运算中的常用操作。 如果一个数太大，无法直接输出，或者不需要直接输出，可以把它取模后，缩小数值再输出。 Python 虽然能直接计算大数，不用担心数据溢出，但是大数乘法太耗时，所以也常用取模来缩小数值。 一个简单应用，判断奇偶：a%2&#x3D;0，a 是偶数">
<meta property="og:type" content="article">
<meta property="og:title" content="简单数论">
<meta property="og:url" content="https://actz123.github.io/2024/02/22/%E7%AE%80%E5%8D%95%E6%95%B0%E8%AE%BA/index.html">
<meta property="og:site_name" content="Actz">
<meta property="og:description" content="简单数论1 模运算 定义：模运算为 a 除以 m 的余数，记为 a mod m，有 a mod m &#x3D; a % m。 模运算是大数运算中的常用操作。 如果一个数太大，无法直接输出，或者不需要直接输出，可以把它取模后，缩小数值再输出。 Python 虽然能直接计算大数，不用担心数据溢出，但是大数乘法太耗时，所以也常用取模来缩小数值。 一个简单应用，判断奇偶：a%2&#x3D;0，a 是偶数">
<meta property="og:locale">
<meta property="article:published_time" content="2024-02-22T09:41:40.000Z">
<meta property="article:modified_time" content="2024-02-22T09:42:15.127Z">
<meta property="article:author" content="zdx">
<meta property="article:tag" content="蓝桥杯备赛">
<meta name="twitter:card" content="summary"><meta name="generator" content="Hexo 7.1.1"></head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1 id="title">
    <a href="/">Actz</a>
  </h1>
  <nav>
    
    
      
      <a class="nav-link" href="/">Home</a>
    
      
        <span class="nav-spacer">×</span>
      
      <a class="nav-link" href="/archives">Archives</a>
    
    
  </nav>
</header>

    <div id="content">
      <article id="post-简单数论" class="article article-type-post" itemprop="blogPost" itemscope>
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 class="article-title" itemprop="headline name">
      简单数论
    </h2>
  


        <div class="article-meta">
          <time class="article-date" datetime="2024-02-22T09:41:40.000Z" itemprop="datePublished">February 22, 2024, 5:41 PM</time>

          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
      
        <h1 id="简单数论"><a href="#简单数论" class="headerlink" title="简单数论"></a>简单数论</h1><h2 id="1-模运算"><a href="#1-模运算" class="headerlink" title="1 模运算"></a>1 模运算</h2><ul>
<li>定义：模运算为 a 除以 m 的余数，记为 a mod m，有 a mod m &#x3D; a % m。</li>
<li>模运算是大数运算中的常用操作。</li>
<li>如果一个数太大，无法直接输出，或者不需要直接输出，可以把它取模后，缩小数值再输出。</li>
<li>Python 虽然能直接计算大数，不用担心数据溢出，但是大数乘法太耗时，所以也常用取模来缩小数值。</li>
<li>一个简单应用，判断奇偶：a%2&#x3D;0，a 是偶数；a%2&#x3D;1，a 是奇数</li>
</ul>
<h3 id="例题：刷题统计-2022-年第十三届省赛，lanqiaoOJ-题号-2098"><a href="#例题：刷题统计-2022-年第十三届省赛，lanqiaoOJ-题号-2098" class="headerlink" title="例题：刷题统计 2022 年第十三届省赛，lanqiaoOJ 题号 2098"></a>例题：刷题统计 2022 年第十三届省赛，lanqiaoOJ 题号 2098</h3><p>【问题描述】 小明决定从下周一开始努力刷题准备蓝桥杯竞赛。他计划周一至周五每天做 a 道题目，周六和周日每天做 b 道题目。请你帮小明计算，按照计划他将在第几天实现做题数大于等于 n 题？</p>
<p>【输入格式】 输入一行包含三个整数 a, b 和 n。</p>
<p>【输出格式】 输出一个整数代表天数。</p>
<p>【评测用例规模与约定】 对于 50%的评测用例，1 ≤ a, b, n ≤ 106106；对于 100%的评测用例，1 ≤ a, b, n ≤ 10181018。</p>
<h3 id="题目解析"><a href="#题目解析" class="headerlink" title="题目解析"></a>题目解析</h3><p>求余数的简单题，利用求余，把计算复杂度降为 O(1)。</p>
<p><strong>C++ 代码：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    ll a,b,n; <span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b&gt;&gt;n;</span><br><span class="line">    ll week = a*<span class="number">5</span>+b*<span class="number">2</span>;     <span class="comment">//每周做题</span></span><br><span class="line">    ll days = (n/week)*<span class="number">7</span>;  <span class="comment">//周数</span></span><br><span class="line">    n %= week;             <span class="comment">//剩下的做题数</span></span><br><span class="line">    <span class="keyword">if</span>(n&lt;=a*<span class="number">5</span>) days += n/a+(n%a?<span class="number">1</span>:<span class="number">0</span>);  <span class="comment">//在周一到周五内</span></span><br><span class="line">    <span class="keyword">else</span>&#123;                  <span class="comment">//周六和周日</span></span><br><span class="line">        days += <span class="number">5</span>, n -= a*<span class="number">5</span>;</span><br><span class="line">        days += n/b+(n%b?<span class="number">1</span>:<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;days;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Java 代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">long</span> <span class="variable">a</span> <span class="operator">=</span> sc.nextLong(), b = sc.nextLong(), n = sc.nextLong();</span><br><span class="line">        <span class="type">long</span> <span class="variable">week</span> <span class="operator">=</span> a * <span class="number">5</span> + b * <span class="number">2</span>;  <span class="comment">//每周做题</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">days</span> <span class="operator">=</span> (n / week) * <span class="number">7</span>; <span class="comment">//周数*7天</span></span><br><span class="line">        n %= week;                  <span class="comment">//余下不够一周的做题数</span></span><br><span class="line">        <span class="keyword">if</span> (n &lt;= a * <span class="number">5</span>)</span><br><span class="line">            days += n / a + (n % a != <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>); <span class="comment">//在周一到周五内</span></span><br><span class="line">        <span class="keyword">else</span> &#123;                       <span class="comment">//周六和周日</span></span><br><span class="line">            days += <span class="number">5</span>;</span><br><span class="line">            n -= a * <span class="number">5</span>;</span><br><span class="line">            days += n / b + (n % b != <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(days);</span><br><span class="line">        sc.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Python 代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a, b, n = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line">week = a * <span class="number">5</span> + b * <span class="number">2</span>  <span class="comment">#每周做题</span></span><br><span class="line">days = (n // week) * <span class="number">7</span>  <span class="comment">#天数</span></span><br><span class="line">n %= week  <span class="comment">#余数</span></span><br><span class="line"><span class="keyword">if</span> n &lt;= a * <span class="number">5</span>:</span><br><span class="line">    days += n // a + (n % a != <span class="number">0</span>)  <span class="comment">#在周一到周五内</span></span><br><span class="line"><span class="keyword">else</span>:  <span class="comment">#周六和周日</span></span><br><span class="line">    days += <span class="number">5</span></span><br><span class="line">    n -= a * <span class="number">5</span></span><br><span class="line">    days += n // b + (n % b != <span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(days)</span><br></pre></td></tr></table></figure>

<h2 id="2-快速幂"><a href="#2-快速幂" class="headerlink" title="2 快速幂"></a>2 快速幂</h2><p>幂运算 an，当 n 很大时，如果一个个乘，时间是 O(n) 的，速度很慢，此时可以用快速幂，在 O(logn) 的时间内算出来。 快速幂的一个解法：分治法，算 a2，然后再算(a2) 2，…，一直算到 an，代码也容易写。</p>
<ul>
<li>标准的快速幂：用位运算实现。</li>
<li>基于位运算的快速幂，原理是倍增。</li>
</ul>
<h3 id="快速幂原理"><a href="#快速幂原理" class="headerlink" title="快速幂原理"></a>快速幂原理</h3><p>以 �11<em>a</em>11 为例说明如何用倍增法做快速幂。</p>
<p>（1）幂次与二进制的关系。把 �11<em>a</em>11 分解成幂 �8、�2、�1<em>a</em>8、<em>a</em>2、<em>a</em>1 的乘积：�11&#x3D;�8+2+1&#x3D;�8×�2×�1<em>a</em>11&#x3D;<em>a</em>8+2+1&#x3D;<em>a</em>8×<em>a</em>2×<em>a</em>1。其中�1、�2、�4、�8…<em>a</em>1、<em>a</em>2、<em>a</em>4、<em>a</em>8…的幂次都是 2 的倍数，所有的幂 ��<em>a**i</em> 都是倍乘关系，逐级递推，代码： a *&#x3D; a</p>
<p>（2）幂次用二进制分解。如何把 11 分解为 8+2+1？利用数的二进制的特征，n &#x3D; 1110 &#x3D; 10112 &#x3D; 23+21+20 &#x3D; 8+2+1，把 n 按二进制处理就可以。</p>
<p>（3）如何跳过那些没有的幂次？例如 1011 需要跳过 �4<em>a</em>4。做个判断，用二进制的位运算实现：</p>
<ul>
<li>n &amp; 1 取 n 的最后一位，并且判断这一位是否需要跳过。</li>
<li>n &gt;&gt;&#x3D; 1 把 n 右移一位，目的是把刚处理过的 n 的最后一位去掉。 幂运算的结果往往很大，一般会先取模再输出。 根据取模的性质有：��mod�&#x3D;(�mod�)�mod�<em>a**n</em>mod<em>m</em>&#x3D;(<em>a</em>mod<em>m</em>)<em>n</em>mod<em>m</em></li>
</ul>
<h3 id="例题：快速幂-lanqiaoOJ-题号-1514"><a href="#例题：快速幂-lanqiaoOJ-题号-1514" class="headerlink" title="例题：快速幂 lanqiaoOJ 题号 1514"></a>例题：快速幂 lanqiaoOJ 题号 1514</h3><p>【题目描述】给定 b, p, k，求(bp) mod k。其中 2≤b, p, k≤109。 【输入描述】三个整数 b，p，k。 【输出描述】输出(bp) mod k。</p>
<h3 id="题目解析-1"><a href="#题目解析-1" class="headerlink" title="题目解析"></a>题目解析</h3><p><strong>C++ 代码：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;     <span class="comment">//变量改用较大的long long</span></span><br><span class="line">ll <span class="title function_">fastPow</span><span class="params">(ll a, ll n, ll mod)</span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    a %= mod;          <span class="comment">//重要，防止下面的ans*a越界</span></span><br><span class="line">    <span class="keyword">while</span>(n) &#123;</span><br><span class="line">        <span class="keyword">if</span>(n &amp; <span class="number">1</span>)   ans = (ans*a) % mod;   <span class="comment">//取模</span></span><br><span class="line">        a = a*a % mod;                     <span class="comment">//取模</span></span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    ll b,p,k;    <span class="built_in">cin</span>&gt;&gt;b&gt;&gt;p&gt;&gt;k;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; fastPow(b,p,k);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Java 代码：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">fastPow</span><span class="params">(<span class="type">long</span> a, <span class="type">long</span> n, <span class="type">long</span> mod)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        a %= mod;   <span class="comment">//重要，防止下面的ans*a越界</span></span><br><span class="line">        <span class="keyword">while</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((n &amp; <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">                ans = (ans * a) % mod;  <span class="comment">//取模</span></span><br><span class="line">            &#125;</span><br><span class="line">            a = (a * a) % mod;  <span class="comment">//取模</span></span><br><span class="line">            n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">long</span> <span class="variable">b</span> <span class="operator">=</span> sc.nextLong(), p = sc.nextLong(), k = sc.nextLong();</span><br><span class="line">        System.out.println(fastPow(b, p, k));</span><br><span class="line">        sc.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Python 代码：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fast_pow</span>(<span class="params">a, n, mod</span>):</span><br><span class="line">    ans = <span class="number">1</span></span><br><span class="line">    a %= mod  <span class="comment">#重要，防止下面的ans*a越界</span></span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">1</span> == <span class="number">1</span>:</span><br><span class="line">            ans = (ans * a) % mod  <span class="comment">#取模</span></span><br><span class="line">        a = (a * a) % mod  <span class="comment">#取模</span></span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">b, p, k = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line"><span class="built_in">print</span>(fast_pow(b, p, k))</span><br></pre></td></tr></table></figure>

<h2 id="GCD-定义、性质"><a href="#GCD-定义、性质" class="headerlink" title="GCD 定义、性质"></a>GCD 定义、性质</h2><p>最大公约数 Greatest Common Divisor(GCD)：整数 a 和 b 的 GCD 是指能同时整除 a 和 b 的最大整数，记为 gcd(a, b)。由于-a 的因子和 a 的因子相同，因此 gcd(a, b) &#x3D; gcd(|a|, |b|)。编码时只关注正整数的最大公约数。 性质： （1）gcd(a, b) &#x3D; gcd(a, a+b) &#x3D; gcd(a, k·a+b) （2）gcd(ka, kb) &#x3D; k·gcd(a, b) （3）定义多个整数的最大公约数：gcd(a, b, c) &#x3D; gcd(gcd(a, b), c)。 （4）若 gcd(a, b) &#x3D; d，则 gcd(a&#x2F;d, b&#x2F;d) &#x3D; 1，即 a&#x2F;d 与 b&#x2F;d 互素。这个定理很重要。 （5）gcd(a+cb, b) &#x3D; gcd(a, b)</p>
<p><strong>C++福利：</strong> c++函数 std::__gcd()，可以返回负数，可以带多个参数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;__gcd(<span class="number">15</span>, <span class="number">81</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;    <span class="comment">// 输出  3</span></span><br><span class="line">    cout&lt;&lt;__gcd(<span class="number">0</span>, <span class="number">44</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;     <span class="comment">// 输出  44</span></span><br><span class="line">    cout&lt;&lt;__gcd(<span class="number">0</span>, <span class="number">0</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;      <span class="comment">// 输出  0</span></span><br><span class="line">    cout&lt;&lt;__gcd(<span class="number">-6</span>, <span class="number">-15</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;   <span class="comment">// 输出  -3</span></span><br><span class="line">    cout&lt;&lt;__gcd(<span class="number">-17</span>,<span class="number">289</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;   <span class="comment">// 输出  -17</span></span><br><span class="line">    cout&lt;&lt;__gcd(<span class="number">17</span>,<span class="number">-289</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;   <span class="comment">// 输出  17</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="手写-GCD-代码"><a href="#手写-GCD-代码" class="headerlink" title="手写 GCD 代码"></a>手写 GCD 代码</h3><p>手写 gcd 函数，常用欧几里得算法。 辗转相除法求 gcd： <code>gcd(a, b) = gcd(b, a mod b)</code> 这是最常用的方法，极为高效。 设 a &gt; b，辗转相除法的计算复杂度为�((���2�)3)<em>O</em>((<em>l<strong>o</strong>g</em>2<em>a</em>)3)。</p>
<p>可输出负数，和库函数一样:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>&#123;     <span class="keyword">return</span> b? gcd(b, a%b):a; &#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;gcd(<span class="number">15</span>, <span class="number">81</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;    <span class="comment">// 输出  3</span></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;gcd(<span class="number">0</span>, <span class="number">44</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;     <span class="comment">// 输出  44</span></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;gcd(<span class="number">0</span>, <span class="number">0</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;      <span class="comment">// 输出  0</span></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;gcd(<span class="number">-6</span>, <span class="number">-15</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;   <span class="comment">// 输出  -3</span></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;gcd(<span class="number">-17</span>,<span class="number">289</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;   <span class="comment">// 输出  -17</span></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;gcd(<span class="number">17</span>,<span class="number">-289</span>)&lt;&lt;<span class="string">&quot;\n&quot;</span>;   <span class="comment">// 输出  17</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 或者使用如下编码方式：</span></span><br><span class="line"><span class="comment">// int GCD(int a,int b)</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     if(b==0)</span></span><br><span class="line"><span class="comment">//         return a;</span></span><br><span class="line"><span class="comment">//     return GCD(b,a%b);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Main</span> &#123;</span></span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> <span class="title function_">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> b == <span class="number">0</span> ? a : gcd(b, a % b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="type">static</span> <span class="type">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(gcd(<span class="number">15</span>, <span class="number">81</span>));   <span class="comment">// 输出  3</span></span><br><span class="line">        System.out.println(gcd(<span class="number">0</span>, <span class="number">44</span>));    <span class="comment">// 输出  44</span></span><br><span class="line">        System.out.println(gcd(<span class="number">0</span>, <span class="number">0</span>));     <span class="comment">// 输出  0</span></span><br><span class="line">        System.out.println(gcd(<span class="number">-6</span>, <span class="number">-15</span>));  <span class="comment">// 输出  -3</span></span><br><span class="line">        System.out.println(gcd(<span class="number">-17</span>, <span class="number">289</span>)); <span class="comment">// 输出  17</span></span><br><span class="line">        System.out.println(gcd(<span class="number">17</span>, <span class="number">-289</span>)); <span class="comment">// 输出  17</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 或者使用如下编码方式：</span></span><br><span class="line"><span class="comment">// static int GCD(int a,int b)</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     if(b==0)</span></span><br><span class="line"><span class="comment">//         return a;</span></span><br><span class="line"><span class="comment">//     return GCD(b,a%b);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line">def <span class="title function_">gcd</span><span class="params">(a, b)</span>:</span><br><span class="line">    <span class="keyword">return</span> a <span class="keyword">if</span> b == <span class="number">0</span> <span class="keyword">else</span> gcd(b, a % b)</span><br><span class="line"></span><br><span class="line">print(gcd(<span class="number">15</span>, <span class="number">81</span>))   # 输出  <span class="number">3</span></span><br><span class="line">print(gcd(<span class="number">0</span>, <span class="number">44</span>))    # 输出  <span class="number">44</span></span><br><span class="line">print(gcd(<span class="number">0</span>, <span class="number">0</span>))     # 输出  <span class="number">0</span></span><br><span class="line">print(gcd(<span class="number">-6</span>, <span class="number">-15</span>))  # 输出  <span class="number">-3</span></span><br><span class="line">print(gcd(<span class="number">-17</span>, <span class="number">289</span>)) # 输出  <span class="number">17</span></span><br><span class="line">print(gcd(<span class="number">17</span>, <span class="number">-289</span>)) # 输出  <span class="number">17</span></span><br><span class="line"></span><br><span class="line"># 或者使用如下编码方式：</span><br><span class="line"><span class="meta"># def GCD(a,b):</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#     <span class="keyword">if</span> b==0:</span></span><br><span class="line"><span class="meta">#         return a</span></span><br><span class="line"><span class="meta">#     return GCD(b,a%b)</span></span><br></pre></td></tr></table></figure>

<h2 id="LCM"><a href="#LCM" class="headerlink" title="LCM"></a>LCM</h2><p>最小公倍数 LCM (the Least Common Multiple) 。· a 和 b 的最小公倍数 lcm(�,�)(<em>a</em>,<em>b</em>),从算术基本定理推理得到。 算术基本定理：任何大于 1 的正整数 n 都可以唯一分解为有限个素数的乘积：</p>
<p>n&#x3D;p1c1p2c2…pmcmn&#x3D;p1c1p2c2…pmcm,其中c1c1 都是正整数，pipi 都是素数且从小到大。</p>
<p>推导 LCM： 设:�&#x3D;�1�1�2�2…����,�&#x3D;�1�1�2�2…����:<em>a</em>&#x3D;<em>p</em>1<em>c</em>1<em>p</em>2<em>c</em>2…<em>p<strong>m</strong>c**m</em>,<em>b</em>&#x3D;<em>p</em>1<em>f</em>1<em>p</em>2<em>f</em>2…<em>p<strong>m</strong>f**m</em></p>
<p>那么：gcd(a, �)&#x3D;�1min⁡�1,�1�2min⁡�2,�2…��min⁡��,��<em>b</em>)&#x3D;<em>p</em>1min<em>c</em>1,<em>f</em>1<em>p</em>2min<em>c</em>2,<em>f</em>2…<em>p**m</em>min<em>c**m</em>,<em>f**m</em></p>
<p>Icm(�,�)&#x3D;�1max⁡�1,�1�2max⁡�2,�2…��max⁡��,��(<em>a</em>,<em>b</em>)&#x3D;<em>p</em>1max<em>c</em>1,<em>f</em>1<em>p</em>2max<em>c</em>2,<em>f</em>2…<em>p**m</em>max<em>c**m</em>,<em>f**m</em></p>
<p>推出：gcd(a, b)<em>lcm(a, b)&#x3D;a</em>b</p>
<p>即：</p>
<p>lcm(�,�):&#x3D;:�∗�&#x2F;gcd(�,�):&#x3D;:�&#x2F;gcd(�,:�)∗�.lcm(<em>a</em>,<em>b</em>):&#x3D;:<em>a</em>∗<em>b</em>&#x2F;gcd(<em>a</em>,<em>b</em>):&#x3D;:<em>a</em>&#x2F;gcd(<em>a</em>,:<em>b</em>)∗<em>b</em>.</p>
<h3 id="lcm-手写代码"><a href="#lcm-手写代码" class="headerlink" title="lcm()手写代码"></a>lcm()手写代码</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//c or c++</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">lcm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>&#123;    <span class="comment">//需要的时候把int改成long long</span></span><br><span class="line">   <span class="keyword">return</span> a / gcd(a, b) * b;  <span class="comment">//先做除法再做乘法，防止先做乘法溢出</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># Python</span><br><span class="line">def <span class="title function_">lcm</span><span class="params">(a, b)</span>:</span><br><span class="line">    <span class="keyword">return</span> a <span class="comment">// gcd(a, b) * b  #先做除法再做乘法，防止先做乘法溢出</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//java</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> <span class="title function_">lcm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> a / gcd(a, b) * b; <span class="comment">//先做除法再做乘法，防止先做乘法溢出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="核桃的数量-2013-年第四届省赛-lanqiaoOJ-题号-210"><a href="#核桃的数量-2013-年第四届省赛-lanqiaoOJ-题号-210" class="headerlink" title="核桃的数量 2013 年第四届省赛 lanqiaoOJ 题号 210"></a>核桃的数量 2013 年第四届省赛 lanqiaoOJ 题号 210</h3><p>【题目描述】小张是软件项目经理，他带领 3 个开发组。工期紧，今天都在加班呢。为鼓舞士气，小张打算给每个组发一袋核桃（据传言能补脑）。他的要求是： 1.各组的核桃数量必须相同 2.各组内必须能平分核桃（当然是不能打碎的） 3.尽量提供满足 1, 2 条件的最小数量（节约闹革命嘛） 【输入格式】输入三个正整数 a, b, c，表示每个组正在加班的人数，用空格分开（a,b,c&lt; 30）<br>【输出格式】输出一个正整数，表示每袋核桃的数量。</p>
<h3 id="题目解析-2"><a href="#题目解析-2" class="headerlink" title="题目解析"></a>题目解析</h3><p>简单题，答案就是三个数字的最小公倍数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">lcm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>&#123; <span class="keyword">return</span> a / __gcd(a, b) * b;&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c;    <span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">    <span class="type">int</span> k = lcm(a,b);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;lcm(k,c)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Main</span> &#123;</span></span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> <span class="title function_">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> b == <span class="number">0</span> ? a : gcd(b, a % b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> <span class="title function_">lcm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a / gcd(a, b) * b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="type">static</span> <span class="type">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Scanner sc = new Scanner(System.in);</span><br><span class="line">        <span class="type">int</span> a = sc.nextInt();</span><br><span class="line">        <span class="type">int</span> b = sc.nextInt();</span><br><span class="line">        <span class="type">int</span> c = sc.nextInt();</span><br><span class="line">        <span class="type">int</span> k = lcm(a, b);</span><br><span class="line">        System.out.println(lcm(k, c));</span><br><span class="line">        sc.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">def <span class="title function_">gcd</span><span class="params">(a, b)</span>:</span><br><span class="line">    <span class="keyword">return</span> a <span class="keyword">if</span> b == <span class="number">0</span> <span class="keyword">else</span> gcd(b, a % b)</span><br><span class="line"></span><br><span class="line">def lcm(a, b):</span><br><span class="line">    <span class="keyword">return</span> a <span class="comment">// gcd(a, b) * b</span></span><br><span class="line"></span><br><span class="line">a, b, c = <span class="built_in">map</span>(<span class="type">int</span>, input().split())</span><br><span class="line">k = lcm(a, b)</span><br><span class="line">print(lcm(k, c))</span><br></pre></td></tr></table></figure>

<h2 id="5-素数的判断"><a href="#5-素数的判断" class="headerlink" title="5 素数的判断"></a>5 素数的判断</h2><p>素数定义：只能被 1 和自己整除的正整数。注：1 不是素数，最小素数是 2。</p>
<p>判断一个数 n 是不是素数：当�≤1014<em>n</em>≤1014时，用试除法；n &gt; 1014 时，试除法不够用，需 要用高级算法，例如 Miller Rabin 算法。</p>
<p><strong>试除法：</strong> 用[2,n-1]内的所有数去试着除 n，如果都不能整除，就是素数。 优化：把[2,n-1]缩小到[2,�][2,<em>n</em>]。证明：若 n &#x3D; axb, 设 a≤�<em>n</em> ,则 b≥�<em>n</em>,如果 a 是 n 的因子，说明 n 不是素数，b 不用再试且 b 一定也是。</p>
<h3 id="C-实现："><a href="#C-实现：" class="headerlink" title="C++ 实现："></a>C++ 实现：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">is_prime</span><span class="params">(<span class="type">long</span> <span class="type">long</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 1不是素数</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">long</span> <span class="type">long</span> i = <span class="number">2</span>; i &lt;= <span class="built_in">sqrt</span>(n); i++)</span><br><span class="line">        <span class="keyword">if</span>(n % i == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 能整除，不是素数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 全不能整除，是素数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> number = <span class="number">29</span>; <span class="comment">// 例子：要检查是否为素数的数值</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">is_prime</span>(number))</span><br><span class="line">        std::cout &lt;&lt; number &lt;&lt; <span class="string">&quot; 是素数。&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        std::cout &lt;&lt; number &lt;&lt; <span class="string">&quot; 不是素数。&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Java-实现："><a href="#Java-实现：" class="headerlink" title="Java 实现："></a>Java 实现：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isPrime</span><span class="params">(<span class="type">long</span> n)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt;= <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 1不是素数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= Math.sqrt(n); i++)</span><br><span class="line">            <span class="keyword">if</span> (n % i == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 能整除，不是素数</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 全不能整除，是素数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.print(<span class="string">&quot;输入一个要检查是否为素数的数值：&quot;</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">number</span> <span class="operator">=</span> scanner.nextLong(); <span class="comment">// 例子：要检查是否为素数的数值</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isPrime(number))</span><br><span class="line">            System.out.println(number + <span class="string">&quot; 是素数。&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            System.out.println(number + <span class="string">&quot; 不是素数。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Python-实现："><a href="#Python-实现：" class="headerlink" title="Python 实现："></a>Python 实现：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">is_prime</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>  <span class="comment"># 1不是素数</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(n ** <span class="number">0.5</span>) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>  <span class="comment"># 能整除，不是素数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>  <span class="comment"># 全不能整除，是素数</span></span><br><span class="line"></span><br><span class="line">number = <span class="number">29</span>  <span class="comment"># 例子：要检查是否为素数的数值</span></span><br><span class="line"><span class="keyword">if</span> is_prime(number):</span><br><span class="line">    <span class="built_in">print</span>(number, <span class="string">&quot;是素数。&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(number, <span class="string">&quot;不是素数。&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="6-素数筛"><a href="#6-素数筛" class="headerlink" title="6 素数筛"></a>6 素数筛</h2><p>素数的筛选：给定 n，求 2~n 内所有的素数。 一个个地判断很慢，所以用“筛子”筛所有的整数，把非素数筛掉，剩下的就是素数。 常用两种筛法：埃氏筛、欧拉筛。</p>
<p><strong>埃氏筛:</strong></p>
<p>初始队列{2、3，4，5，6，7，8，9，10，11，12，13，…，n}，操作步骤： （1）输出最小的素数 2，筛掉 2 的倍数，得{2，3，4，5，6，7，8，9，10，11，12，13，…} （2）输出最小的素数 3，筛掉 3 的倍数，得{2，3，4，5，6，7，8，9，10，11，12，13，…} （3）输出最小的素数 5，筛掉 5 的倍数，得{2，3，4，5，6，7，8，9，10，11，12，13，…} 继续以上步骤，直到队列为空。</p>
<h3 id="C-实现：-1"><a href="#C-实现：-1" class="headerlink" title="C++ 实现："></a>C++ 实现：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> primes[N],cnt;</span><br><span class="line"><span class="type">bool</span> bprime[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getPrime</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(bprime,<span class="literal">false</span>,<span class="built_in">sizeof</span>(bprime));</span><br><span class="line">    bprime[<span class="number">0</span>]=<span class="literal">true</span>;</span><br><span class="line">    bprime[<span class="number">1</span>]=<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!bprime[i])&#123;</span><br><span class="line">            prime[cnt++]=i;</span><br><span class="line">            <span class="keyword">for</span>(LL j=i*<span class="number">2</span>;j&lt;=n;j+=i)</span><br><span class="line">                bprime[j]=<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Java-实现：-1"><a href="#Java-实现：-1" class="headerlink" title="Java 实现："></a>Java 实现：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>[] primes = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="type">boolean</span>[] bprime = <span class="keyword">new</span> <span class="title class_">boolean</span>[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">getPrimes</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    Arrays.fill(bprime, <span class="literal">false</span>);</span><br><span class="line">    bprime[<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">    bprime[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!bprime[i]) &#123;</span><br><span class="line">            primes[cnt++] = i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i * <span class="number">2</span>; j &lt;= n; j += i) &#123;</span><br><span class="line">                bprime[j] = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Python-实现：-1"><a href="#Python-实现：-1" class="headerlink" title="Python 实现："></a>Python 实现：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">primes = [<span class="number">0</span>] * N</span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line">bprime = [<span class="literal">False</span>] * N</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getPrimes</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">global</span> cnt, primes, bprime</span><br><span class="line">    bprime[<span class="number">0</span>] = <span class="literal">True</span></span><br><span class="line">    bprime[<span class="number">1</span>] = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> bprime[i]:</span><br><span class="line">            primes[cnt] = i</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i*<span class="number">2</span>, n+<span class="number">1</span>, i):</span><br><span class="line">                bprime[j] = <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<p><strong>但是埃氏筛法的缺点：例如 6 会被 3 整除，6 会被 2 整除，会被筛两次，所以我们再给出欧氏线性筛法：</strong></p>
<h3 id="C-实现：-2"><a href="#C-实现：-2" class="headerlink" title="C++ 实现："></a>C++ 实现：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> primes[N],cnt;</span><br><span class="line"><span class="type">bool</span> bPrime[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getPrimes</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(bPrime,<span class="literal">false</span>,<span class="built_in">sizeof</span>(bPrime));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!bPrime[i])</span><br><span class="line">            primes[cnt++]=i;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;cnt&amp;&amp;i*primes[j]&lt;n;j++)&#123;</span><br><span class="line">            bPrime[i*primes[j]]=<span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%primes[j]==<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Java-实现：-2"><a href="#Java-实现：-2" class="headerlink" title="Java 实现："></a>Java 实现：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="type">int</span>[] primes = <span class="keyword">new</span> <span class="title class_">int</span>[N], bPrime = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="type">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getPrimes</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    Arrays.fill(bPrime, <span class="number">0</span>, n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (bPrime[i] == <span class="number">0</span>)</span><br><span class="line">            primes[cnt++] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; cnt &amp;&amp; i * primes[j] &lt;= n; j++) &#123;</span><br><span class="line">            bPrime[i * primes[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % primes[j] == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Python-实现：-2"><a href="#Python-实现：-2" class="headerlink" title="Python 实现："></a>Python 实现：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">1000005</span></span><br><span class="line">primes = [<span class="number">0</span>] * N</span><br><span class="line">bprime = [<span class="literal">False</span>] * N</span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getPrimes</span>(<span class="params">n: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">global</span> cnt</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> bprime[i]:</span><br><span class="line">            primes[cnt] = i</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> j &lt; cnt <span class="keyword">and</span> i * primes[j] &lt;= n:</span><br><span class="line">            bprime[i * primes[j]] = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> i % primes[j] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            j += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="例题：质数-lanqiaoOJ-题号-1557"><a href="#例题：质数-lanqiaoOJ-题号-1557" class="headerlink" title="例题：质数 lanqiaoOJ 题号 1557"></a>例题：质数 lanqiaoOJ 题号 1557</h3><p>【题目描述】给定一个正整数 N，请你输出 N 以内（不包含 N）的质数以及质数的个数。 【输入描述】一个正整数 N，n&lt;1000 【输出描述】两行，第 1 行包含若干个素数，从小到大输出，用空格分开。第 2 行一个整数，表示素数个数。</p>
<p>输入： 10</p>
<p>输出： 2 3 5 7 4</p>
<p>题目为模板题目，实现方式如下，其中：</p>
<ul>
<li>bprime[i]记录数 i 的状态，若 bprime [i]&#x3D;1，表示它被筛掉，不是素数。</li>
<li>用 primes[]存放素数，prime[0]是第一个素数 2。</li>
<li>Cnt 是素数个数计数</li>
</ul>
<h3 id="C-实现：-3"><a href="#C-实现：-3" class="headerlink" title="C++ 实现："></a>C++ 实现：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span>;</span><br><span class="line"><span class="type">int</span> primes[N],cnt;</span><br><span class="line"><span class="type">bool</span> bprime[N]; <span class="comment">//true表示被筛掉，不是素数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">getPrimes</span><span class="params">(<span class="type">int</span> n)</span></span>&#123; <span class="comment">//埃氏筛，计算[2, n]内的素数</span></span><br><span class="line">        <span class="built_in">memset</span>(bprime,<span class="literal">false</span>,<span class="built_in">sizeof</span>(bprime));</span><br><span class="line">        bprime[<span class="number">0</span>]=<span class="literal">true</span>;</span><br><span class="line">        bprime[<span class="number">1</span>]=<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!bprime[i])&#123;</span><br><span class="line">                primes[cnt++]=i;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> j=i*<span class="number">2</span>;j&lt;=n;j+=i)</span><br><span class="line">                    bprime[j]=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt;n;</span><br><span class="line">    <span class="built_in">getPrimes</span>(n<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;cnt;i++)  cout &lt;&lt; primes[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Java-实现：-3"><a href="#Java-实现：-3" class="headerlink" title="Java 实现："></a>Java 实现：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">1000000</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] primes = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">boolean</span>[] bprime = <span class="keyword">new</span> <span class="title class_">boolean</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> cnt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getPrimes</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        bprime[<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">        bprime[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!bprime[i]) &#123;</span><br><span class="line">                primes[cnt++] = i;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i * <span class="number">2</span>; j &lt;= n; j += i) &#123;</span><br><span class="line">                    bprime[j] = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">        getPrimes(n - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; cnt; i++) &#123;</span><br><span class="line">            System.out.print(primes[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        System.out.println(cnt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Python-实现：-3"><a href="#Python-实现：-3" class="headerlink" title="Python 实现："></a>Python 实现：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">10</span>**<span class="number">6</span></span><br><span class="line">primes = []</span><br><span class="line">bprime = [<span class="literal">False</span>] * N</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getPrimes</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">global</span> primes</span><br><span class="line">    <span class="keyword">global</span> cnt</span><br><span class="line"></span><br><span class="line">    bprime[<span class="number">0</span>] = <span class="literal">True</span></span><br><span class="line">    bprime[<span class="number">1</span>] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> bprime[i]:</span><br><span class="line">            primes.append(i)</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i*<span class="number">2</span>, n+<span class="number">1</span>, i):</span><br><span class="line">                bprime[j] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line">getPrimes(n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> primes:</span><br><span class="line">    <span class="built_in">print</span>(p, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cnt)</span><br></pre></td></tr></table></figure>

<h2 id="7-分解质因子"><a href="#7-分解质因子" class="headerlink" title="7 分解质因子"></a>7 分解质因子</h2><p>任何一个正整数 n 都可以唯一地分解为有限个素数的乘积：�&#x3D;�1�1�2�2…����<em>n</em>&#x3D;<em>p</em>1<em>c</em>1<em>p</em>2<em>c</em>2…<em>p<strong>m</strong>c**m</em>,其中�i<em>c</em>i都是正整数，p<em>i 都是素数且从小到大。 分解质因子也可以用试除法。求 n 的质因子： (1) 第一步，求最小质因子$p</em>{1}。逐个检查从2到。逐个检查从2到\sqrt{n}的所有素数，如果它能整除�，就是最小质因子。然后连续用�的所有素数，如果它能整除<em>n</em>，就是最小质因子。然后连续用<em>p</em><em>{1}除�，目的是去掉�中的�除*n</em>，目的是去掉*n<em>中的*p</em><em>{1},得到�,得到</em>n**{1}。(2)第二步，再找�。(2)第二步，再找*n**{1}的最小质因子。逐个检查从�的最小质因子。逐个检查从<em>p</em><em>{1}到到\quad\sqrt{n1}\quad\text{的所有素数。从p}</em>{1}开始试除，是因为�开始试除，是因为<em>n</em><em>{1}没有比�没有比*P</em><em>{1}小的素因子，而且�小的素因子，而且</em>n*_{1}$的因子也是 n 的因子。 (3)继续以上步骤，直到找到所有质因子。</p>
<p>我们直接看一个例题：</p>
<p>【题目描述】求出区间[a,b]中所有整数的质因数分解。 【输入描述】输入一行，包含 2 个整数 a，b。2&lt;&#x3D;a&lt;&#x3D;b&lt;&#x3D;10000 【输出描述】每行输出一个数的分解，形如 k&#x3D;a1×a2×a3×…，k 从小到大，a 从小到大。</p>
<p>输入： 3 10</p>
<p>输出： $\begin{aligned} &amp;\text{3&#x3D;} \text{3} \ &amp;\text{4&#x3D;} 2\times2 \ &amp;\text{5&#x3D;} \text{5} \ &amp;6&#x3D;2\times3 \ &amp;\text{7&#x3D;7} \ &amp;8&#x3D;2\times2\times2 \ &amp;9&#x3D;3\times3 \ &amp;10&#x3D;2\times5 \end{aligned}$</p>
<p>直接对每个数进行分解，然后打印出它的因数。</p>
<h3 id="C-实现：-4"><a href="#C-实现：-4" class="headerlink" title="C++ 实现："></a>C++ 实现：</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> p[<span class="number">20</span>];  <span class="comment">//p[]记录因子，p[1]是最小因子。一个int数的质因子最多有10几个</span></span><br><span class="line"><span class="type">int</span> c[<span class="number">40</span>];  <span class="comment">//c[i]记录第i个因子的个数。一个因子的个数最多有30几个</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">factor</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= <span class="built_in">sqrt</span>(n); i++)</span><br><span class="line">        <span class="keyword">if</span>(n%i == <span class="number">0</span>)&#123;</span><br><span class="line">            p[++m] = i, c[m] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(n%i == <span class="number">0</span>)            <span class="comment">//把n中重复的因子去掉</span></span><br><span class="line">                n/=i, c[m]++;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span>(n&gt;<span class="number">1</span>)                           <span class="comment">//没有被除尽，是素数</span></span><br><span class="line">        p[++m] = n, c[m] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> m;                         <span class="comment">//共m个因子</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b;   cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=a;i&lt;=b;i++)&#123;</span><br><span class="line">        <span class="type">int</span> m = <span class="built_in">factor</span>(i);</span><br><span class="line">        cout&lt;&lt;i&lt;&lt;<span class="string">&quot;=&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;j++)&#123; <span class="comment">//第j个因子</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>;k&lt;=c[j];k++)&#123;    <span class="comment">//第j个因子的个数</span></span><br><span class="line">                cout &lt;&lt;p[j];</span><br><span class="line">                <span class="keyword">if</span>(k&lt;c[j]) cout &lt;&lt;<span class="string">&quot;*&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(j&lt;m) cout &lt;&lt;<span class="string">&quot;*&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Java-实现：-4"><a href="#Java-实现：-4" class="headerlink" title="Java 实现："></a>Java 实现：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] p = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">20</span>];  <span class="comment">// p[] 记录因子，p[1] 是最小因子。一个 int 数的质因子最多有 10 几个</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] c = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">40</span>];  <span class="comment">// c[i] 记录第 i 个因子的个数。一个因子的个数最多有 30 几个</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">factor</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= Math.sqrt(n); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">                p[++m] = i;</span><br><span class="line">                c[m] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">                    n /= i;</span><br><span class="line">                    c[m]++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            p[++m] = n;</span><br><span class="line">            c[m] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> sc.nextInt(), b = sc.nextInt();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> a; i &lt;= b; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> factor(i);</span><br><span class="line">            System.out.print(i + <span class="string">&quot;=&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">1</span>; k &lt;= c[j]; k++) &#123;</span><br><span class="line">                    System.out.print(p[j]);</span><br><span class="line">                    <span class="keyword">if</span> (k &lt; c[j]) &#123;</span><br><span class="line">                        System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (j &lt; m) &#123;</span><br><span class="line">                    System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Python-实现：-4"><a href="#Python-实现：-4" class="headerlink" title="Python 实现："></a>Python 实现：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">p = [<span class="number">0</span>] * <span class="number">20</span>  <span class="comment"># p[] 记录因子，p[1] 是最小因子。一个 int 数的质因子最多有 10 几个</span></span><br><span class="line">c = [<span class="number">0</span>] * <span class="number">40</span>  <span class="comment"># c[i] 记录第 i 个因子的个数。一个因子的个数最多有 30 几个</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor</span>(<span class="params">n</span>):</span><br><span class="line">    m = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(math.sqrt(n)) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</span><br><span class="line">            m += <span class="number">1</span></span><br><span class="line">            p[m], c[m] = i, <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> n % i == <span class="number">0</span>:</span><br><span class="line">                n //= i</span><br><span class="line">                c[m] += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n &gt; <span class="number">1</span>:</span><br><span class="line">        m += <span class="number">1</span></span><br><span class="line">        p[m], c[m] = n, <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">a, b = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(a, b+<span class="number">1</span>):</span><br><span class="line">    m = factor(i)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;i&#125;</span>=&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, m+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, c[j]+<span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(p[j], end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> k &lt; c[j]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> j &lt; m:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;*&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    <div class="article-category">
      
        <b>Categories:</b>
        <a class="article-category-link" href="/categories/%E8%93%9D%E6%A1%A5%E6%9D%AF%E5%86%B2%E5%88%BA%E8%90%A5/">蓝桥杯冲刺营</a>, <a class="article-category-link" href="/categories/%E8%93%9D%E6%A1%A5%E6%9D%AF%E5%86%B2%E5%88%BA%E8%90%A5/12-%E7%AE%80%E5%8D%95%E6%95%B0%E8%AE%BA/">12.简单数论</a>
      
      
        <br/>
      
      
        <b>Tags:</b>
        <a class="article-tag-none-link" href="/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF%E5%A4%87%E8%B5%9B/" rel="tag">蓝桥杯备赛</a>
      
    </div>
    
    
  </div>
</article>

  
<nav id="article-nav" class="article-nav">
  
    <a href="/2024/02/22/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          组合数学
        
      </div>
    </a>
  
  
    <a href="/2024/02/22/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          图论入门
        
      </div>
    </a>
  
</nav>






    </div>
  </div>
  




<div id="settings-container">
  <div id="dark-mode">dark</div>
  <div id="sans-font">sans</div>
</div>
<script type="text/javascript">
let d=document,r=d.documentElement.style,f=r.setProperty.bind(r),l=localStorage,s=l.getItem('s')||(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches),n=l.getItem('n'),m=d.getElementById("dark-mode"),b=()=>{f('--bg-color','#fafafa');f('--code-bg-color','#f4f4f4');f('--text-color','#212121');f('--secondary-color','#808080');f('--tertiary-color','#b0b0b0');f('--link-color','#b5c8cf');f('--link-hover-color','#618794');f('--link-bg-color','#dae4e7');f('--selection-color','#dae4e7');m.innerHTML="dark"},c=()=>{f('--bg-color','#212121');f('--code-bg-color','#292929');f('--text-color','#fff');f('--secondary-color','#c0c0c0');f('--tertiary-color','#6e6e6e');f('--link-color','#4d6b75');f('--link-hover-color','#96b1bb');f('--link-bg-color','#5d828e');f('--selection-color','#acc1c9');m.innerHTML="light"},o=d.getElementById("sans-font"),e=()=>{f('--body-stack','"Lora", "Georgia", "Times New Roman", serif');o.innerHTML="sans"},g=()=>{f('--body-stack','"Lato", "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", "Verdana", sans-serif');o.innerHTML="serif"};m.onclick=()=>{if(s==2){s=1;l.setItem('s',s);c()}else{s=2;l.setItem('s',s);b()}};o.onclick=()=>{if(n==2){n=1;l.setItem('n',n);g()}else{n=2;l.setItem('n',n);e()}};if(!s){s=2;l.setItem('s',2)};if(s==1){c()};if(!n){n=2;l.setItem('n',2)};if(n==1){g()};
</script>




</body>
</html>
