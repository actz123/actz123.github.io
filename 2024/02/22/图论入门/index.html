<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#33363b">
    <meta name="msapplication-TileColor" content="#33363b">
    
    
    
    
    <meta name="keywords" content="Life, ARIA, Hexo">
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    
    
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-chrome-192x192.png">
    
    
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    
    
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    
    
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#33363b">
    
    
    <link rel="manifest" href="/favicons/site.webmanifest">
    
    
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    
    
    <link rel="alternate" href="/atom.xml" title="Actz" type="application/atom+xml" />
    
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicons/favicon.ico">
    
    
    <link rel="stylesheet" type="text/css" href="/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/css/index.css">
    
    <link rel="stylesheet" type="text/css" href="/css/sidebar.css">
    
    
<link rel="stylesheet" type="text/css" href="/css/page.css">
<link rel="stylesheet" type="text/css" href="/css/post.css">

    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <link rel="stylesheet" type="text/css" href="/css/atom-one-dark.css">
    <link rel="stylesheet" type="text/css" href="/css/lightgallery.min.css">
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script defer type="text/javascript" src="/js/util.js"></script>
    <script defer type="text/javascript" src="/js/clipboard.min.js"></script>
    <script defer type="text/javascript" src="/js/scrollspy.js"></script>
    <script defer type="text/javascript" src="/js/fontawesome-all.min.js"></script>
    <script defer type="text/javascript" src="/js/lightgallery.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-fullscreen.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-hash.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-pager.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-thumbnail.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-zoom.min.js"></script>
    
    <script defer src="/js/busuanzi.pure.mini.js"></script>
    
    
    <script defer type="text/javascript" src="/js/search.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      var searchPath = "search.json";
      if (searchPath.length === 0) {
        searchPath = "search.xml";
      }
      var path = "/" + searchPath;
      searchFunc(path, "search-input", "search-result");
    });
    </script>
    
    
    <script defer type="text/javascript" src="/js/index.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      var cb = null;
      var els = $(".post figure.highlight");
      if (els.length) {
        // Enabled Hexo highlight line number.
        $(els).each(function (i, e) {
          // $(e).before("<button class=\"copy button\">复制</button>");
          $(e).before([
            "<div class=\"code-titlebar\">",
              "<div class=\"titlebar-left\">",
                "<button class=\"copy\" aria-label=\"复制\"><i class=\"far fa-copy\"></i></button>",
              "</div>",
              "<div class=\"titlebar-center\">",
                "code",
              "</div>",
              "<div class=\"titlebar-right\">",
                "<button class=\"button-dot dot-minimize\" aria-label=\"Decoration\"></button>",
                "<button class=\"button-dot dot-maximize\" aria-label=\"Decoration\"></button>",
                "<button class=\"button-dot dot-close\" aria-label=\"Decoration\"></button>",
              "</div>",
            "</div>"
          ].join(""));
        });
        cb = new ClipboardJS("button.copy", {
          "target": function (trigger) {
              // Get target element by DOM API.
              return trigger.parentNode.parentNode.nextElementSibling.firstChild.firstChild.firstChild.lastChild.firstChild.firstChild;
          }
        });
      } else {
        // Disabled Hexo highlight line number.
        els = $(".post pre code");
        $(els).each(function (i, e) {
          // Add button before pre, not code.
          // $(e).parent().before("<button class=\"copy button\">复制</button>");
          $(e).before([
            "<div class=\"code-titlebar\">",
              "<div class=\"titlebar-left\">",
                "<button class=\"copy\" aria-label=\"复制\"><i class=\"far fa-copy\"></i></button>",
              "</div>",
              "<div class=\"titlebar-center\">",
                "code",
              "</div>",
              "<div class=\"titlebar-right\">",
                "<button class=\"button-dot dot-minimize\" aria-label=\"Decoration\"></button>",
                "<button class=\"button-dot dot-maximize\" aria-label=\"Decoration\"></button>",
                "<button class=\"button-dot dot-close\" aria-label=\"Decoration\"></button>",
              "</div>",
            "</div>"
          ].join(""));
        });
        cb = new ClipboardJS("button.copy", {
          "target": function (trigger) {
              // Get target element by DOM API.
              return trigger.parentNode.parentNode.nextElementSibling;
          }
        });
      }
      cb.on("success", function (e) {
        e.clearSelection();
        var trigger = e.trigger;
        // Change button text as a user tip.
        trigger.innerHTML = "<i class=\"far fa-check-square\"></i>";
        $(trigger).addClass("copied");
        // Change button text back;
        setTimeout(function () {
          trigger.innerHTML = "<i class=\"far fa-copy\"></i>";
          $(trigger).removeClass("copied");
        }, 1500);
      });
    });
    </script>
    
    <script defer type="text/javascript" src="/js/custom.js"></script>
    <title>图论入门 | Actz</title>
  <meta name="generator" content="Hexo 7.1.1"></head>
  <body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"  data-spy="scroll" data-target=".list-group">
    
<header id="header" class="header" style="background: #33363b;">
  <div class="container">
    <div class="header-container">
      <div class="header-title">
        <h1 class="title"><a href="/">Actz</a></h1>
        <h2 class="subtitle"></h2>
      </div>
      
      <div class="logo">
        <img src="/images/logo.png" alt="logo">
      </div>
      
    </div>
    <nav id="nav" class="nav">
      <a id="nav-toggle" class="nav-toggle" aria-hidden="true"><i class="fas fa-bars" aria-label="切换导航栏"></i></a>
      <ul id="menu" role="menubar" aria-hidden="false">
        
        <li role="menuitem"><a href="/"><i class="fas fa-home"></i><span class="menu-text">首页</span></a></li>
        
        <li role="menuitem"><a href="/archives/"><i class="fas fa-archive"></i><span class="menu-text">归档</span></a></li>
        
        <li role="menuitem"><a href="/categories/"><i class="fas fa-th-list"></i><span class="menu-text">分类</span></a></li>
        
        <li role="menuitem"><a href="/tags/"><i class="fas fa-tags"></i><span class="menu-text">标签</span></a></li>
        
        <li role="menuitem"><a href="/about/"><i class="fas fa-user-edit"></i><span class="menu-text">关于</span></a></li>
        
      </ul>
    </nav>
  </div>
</header>


    <main id="main" class="main">
      <div class="container">
        <div class="main-container">
          <div class="content">
            
<div id="post" class="page">
  
  <article class="article post card" itemscope itemtype="http://schema.org/Article">
    <div class="post-block">
      <link itemprop="mainEntityOfPage" href="https://actz123.github.io/2024/02/22/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/">
      <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
       <meta itemprop="name" content="zdx">
       <meta itemprop="description" content="">
       <meta itemprop="image" content="/images/avatar.png">
      </span>
      <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
       <meta itemprop="name" content="Actz">
      </span>
    </div>
    <header class="post-header">
      <h1 class="post-title" itemprop="name headline">图论入门</h1>
      <div class="post-meta">
        
        <span class="post-date">
          <i class="far fa-calendar-plus"></i><span><time title="post-date" itemprop="dateCreated datePublished" datetime="2024-02-22T17:40:17+08:00">2024-02-22 17:40:17</time></span>
        </span>
        
        
        
        <span class="post-meta-divider divider">|</span>
        
        <span class="post-categories">
          
          <i class="far fa-folder-open"></i><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E8%93%9D%E6%A1%A5%E6%9D%AF%E5%86%B2%E5%88%BA%E8%90%A5/" itemprop="url" rel="index"><span itemprop="name">蓝桥杯冲刺营</span></a></span><i class="fas fa-angle-right"></i><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E8%93%9D%E6%A1%A5%E6%9D%AF%E5%86%B2%E5%88%BA%E8%90%A5/11-%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/" itemprop="url" rel="index"><span itemprop="name">11.图论入门</span></a></span>
        </span>
        
        
      </div>
    </header>
    <main class="post-main" itemprop="articleBody">
      <h1 id="图论"><a href="#图论" class="headerlink" title="图论"></a>图论</h1><p>本章节为图论最基本的内容，要求每位同学都要尽量掌握。</p>
<h2 id="图的基本概念"><a href="#图的基本概念" class="headerlink" title="图的基本概念"></a>图的基本概念</h2><p>图：由点(<code>node</code>，或者 <code>vertex</code>)和连接点的边(<code>edge</code>)组成。图是点和边构成的网。</p>
<p>树：特殊的图</p>
<p>树，即连通无环图树的结点从根开始，层层扩展子树，是一种层次关系，这种层次关系，保证了树上不会出现环路。两点之间的路径：有且仅有一条路径。最近公共祖先。</p>
<h3 id="图的种类"><a href="#图的种类" class="headerlink" title="图的种类"></a>图的种类</h3><p>（1）无向无权图，边没有权值、没有方向； （2）有向无权图，边有方向、无权值； （3）加权无向图，边有权值，但没有方向； （4）加权有向图； （5）有向无环图（Directed Acyclic Graph，DAG）。</p>
<h3 id="图算法的时间分析"><a href="#图算法的时间分析" class="headerlink" title="图算法的时间分析"></a>图算法的时间分析</h3><p>图算法的复杂度和边的数量 E、点的数量 V 相关。�(�+�)<em>O</em>(<em>V</em>+<em>E</em>)：几乎是图问题中能达到的最好程度。�(�log⁡�)<em>O</em>(<em>V</em>log<em>E</em>)、�(�log⁡�)<em>O</em>(<em>E</em>log<em>V</em>)：很好的算法。�(�2)<em>O</em>(<em>V</em>2)、�(�2)<em>O</em>(<em>E</em>2)或更高：不算是好的算法。</p>
<h2 id="图的存储"><a href="#图的存储" class="headerlink" title="图的存储"></a>图的存储</h2><p>能快速访问：图的存储，能让程序很快定位结点 <code>u</code> 和 <code>v</code> 的边<code>(u, v)</code> 。</p>
<ul>
<li>数组存边：简单、空间使用最少；无法快递定位</li>
<li>邻接矩阵：简单、空间使用最大；定位最快 <code>dis[a][b]</code></li>
<li>邻接表：空间很少，定位较快</li>
<li>链式前向星：空间更少，定位较快</li>
</ul>
<p><strong>注： 存储方式跟题目相匹配，占用空间少定位快也不一定是问题的最优存储方式。</strong></p>
<h3 id="数组存边"><a href="#数组存边" class="headerlink" title="数组存边"></a>数组存边</h3><p>优点：简单、最省空间。 缺点：无法定位某条边。 应用：<code>bellman-ford</code> 算法、最小生成树的 <code>kruskal</code> 算法</p>
<figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// c/c++实现</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> from,to,dis;</span><br><span class="line">&#125;e[M]; <span class="comment">//结构体数组存边</span></span><br><span class="line"></span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)</span><br><span class="line">    cin&gt;&gt;e[i].from&gt;&gt;e[i].to&gt;&gt;e[i].dis;</span><br><span class="line"><span class="comment">//Java实现</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Edge</span> &#123; <span class="type">int</span> from; <span class="type">int</span> to; <span class="type">int</span> dis;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Edge</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to, <span class="type">int</span> dis)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.from = from;</span><br><span class="line">        <span class="keyword">this</span>.to = to;</span><br><span class="line">        <span class="keyword">this</span>.dis = dis;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Edge[] e = <span class="keyword">new</span> Edge[M];</span><br><span class="line"></span><br><span class="line">Scanner sc = <span class="keyword">new</span> <span class="built_in">Scanner</span>(System.in);</span><br><span class="line"><span class="type">int</span> n = sc.<span class="built_in">nextInt</span>();</span><br><span class="line"><span class="type">int</span> m = sc.<span class="built_in">nextInt</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> from = sc.<span class="built_in">nextInt</span>();</span><br><span class="line">    <span class="type">int</span> to = sc.<span class="built_in">nextInt</span>();</span><br><span class="line">    <span class="type">int</span> dis = sc.<span class="built_in">nextInt</span>();</span><br><span class="line">    e[i] = <span class="keyword">new</span> <span class="built_in">Edge</span>(from, to, dis);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#python实现</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Edge</span>:</span><br><span class="line">    <span class="function">def <span class="title">init</span><span class="params">(self, f, t, d)</span>:</span></span><br><span class="line"><span class="function">        self.from =</span> f</span><br><span class="line">        self.to = t</span><br><span class="line">        self.dis = d</span><br><span class="line"></span><br><span class="line">e = [<span class="built_in">Edge</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>) <span class="keyword">for</span> i in <span class="built_in">range</span>(M)]</span><br><span class="line"></span><br><span class="line">n, m = <span class="built_in">map</span>(<span class="type">int</span>, <span class="built_in">input</span>().<span class="built_in">split</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">1</span>, m + <span class="number">1</span>):</span><br><span class="line">    e[i].from, e[i].to, e[i].dis = <span class="built_in">map</span>(<span class="type">int</span>, <span class="built_in">input</span>().<span class="built_in">split</span>())</span><br></pre></td></tr></table></figure>

<h3 id="邻接矩阵"><a href="#邻接矩阵" class="headerlink" title="邻接矩阵"></a>邻接矩阵</h3><p>二维数组： ����ℎ[���][���]<em>g<strong>r</strong>a<strong>p</strong>h</em>[<em>N<strong>U</strong>M</em>][<em>N<strong>U</strong>M</em>] 无向图： ����ℎ[�][�]&#x3D;����ℎ[�][�]。<em>g<strong>r</strong>a<strong>p</strong>h</em>[<em>i</em>][<em>j</em>]&#x3D;<em>g<strong>r</strong>a<strong>p</strong>h</em>[<em>j</em>][<em>i</em>]。 有向图： ����ℎ[�][�]≠����ℎ[�][�]。<em>g<strong>r</strong>a<strong>p</strong>h</em>[<em>i</em>][<em>j</em>]&#x3D;<em>g<strong>r</strong>a<strong>p</strong>h</em>[<em>j</em>][<em>i</em>]。 权值： ����ℎ[�][�]存结点�到�的边的权值。<em>g<strong>r</strong>a<strong>p</strong>h</em>[<em>i</em>][<em>j</em>]存结点<em>i</em>到<em>j</em>的边的权值。 例如 ����ℎ[1][2]&#x3D;3，����ℎ[2][1]&#x3D;5等等。<em>g<strong>r</strong>a<strong>p</strong>h</em>[1][2]&#x3D;3，<em>g<strong>r</strong>a<strong>p</strong>h</em>[2][1]&#x3D;5等等。 用 ����ℎ[�][�]&#x3D;���表示�，�之间无边。<em>g<strong>r</strong>a<strong>p</strong>h</em>[<em>i</em>][<em>j</em>]&#x3D;<em>I<strong>N</strong>F</em>表示<em>i</em>，<em>j</em>之间无边。</p>
<p>优点：</p>
<ul>
<li>适合稠密图；</li>
<li>编码非常简短；</li>
<li>对边的存储、查询、更新等操作又快又简单。</li>
</ul>
<p>缺点：</p>
<ul>
<li>存储复杂度 �(�2)<em>O</em>(<em>V</em>2)太高。V&#x3D;10000 时，空间 100M。</li>
<li>不能存储重边。</li>
</ul>
<h3 id="邻接表和链式前向星"><a href="#邻接表和链式前向星" class="headerlink" title="邻接表和链式前向星"></a>邻接表和链式前向星</h3><p>邻接表（指针或数组下标）和链式前向星（容器模拟）的思路一样，只是表达方式不同。</p>
<p><img src="/./../imgs/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/29bc6278e9e147f9597ba0c263fc1903-0.png" alt="图片描述"></p>
<figure class="hljs highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></span><br><span class="line">    <span class="type">int</span> from, to; <span class="type">long</span> <span class="type">long</span> w; <span class="comment">//起点，终点，权值。起点from并没有用到，e[i]的i就是from</span></span><br><span class="line">    edge(<span class="type">int</span> a, <span class="type">int</span> b,<span class="type">long</span> <span class="type">long</span> c)&#123;from=a; to=b; w=c;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt;e[N];          <span class="comment">//用于存储图</span></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> from, to;</span><br><span class="line">    <span class="type">long</span> w;</span><br><span class="line"></span><br><span class="line">    Edge(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">long</span> c) &#123;</span><br><span class="line">        from = a;</span><br><span class="line">        to = b;</span><br><span class="line">        w = c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">static</span> ArrayList&lt;Edge&gt;[] e = new ArrayList[N];</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Edge</span>:</span></span><br><span class="line">    def __init__(self, fr, to, w):</span><br><span class="line">        self.fr = fr</span><br><span class="line">        self.to = to</span><br><span class="line">        self.w = w</span><br><span class="line"></span><br><span class="line">e = [[] <span class="keyword">for</span> _ in range(N)]</span><br></pre></td></tr></table></figure>

<p>我们会在使用的时候进行讲解。</p>
<h2 id="最短路问题"><a href="#最短路问题" class="headerlink" title="最短路问题"></a>最短路问题</h2><p>最广为人知的图论问题就是最短路径问题。</p>
<p>简单图的最短路径</p>
<ul>
<li>树上的路径：任意 22 点之间</li>
</ul>
<p>只有一条路径</p>
<ul>
<li>所有边长都为 11 的图：用 <code>BFS</code> 搜最短路径，复杂度 �(�+�)<em>O</em>(<em>n</em>+<em>m</em>)</li>
</ul>
<p>普通图的最短路径</p>
<ul>
<li>边长：不一定等于 11，而且可能为负数</li>
<li>算法：<code>Floyd</code>、<code>Dijkstra</code>、<code>SPFA</code> 等，各有应用场景，不可互相替代</li>
</ul>
<h3 id="最短路算法比较"><a href="#最短路算法比较" class="headerlink" title="最短路算法比较"></a>最短路算法比较</h3><table>
<thead>
<tr>
<th>问题</th>
<th>边权</th>
<th>算法</th>
<th>时间复杂度</th>
</tr>
</thead>
<tbody><tr>
<td>一个起点，一个终点</td>
<td>非负数；无边权（或边权为 1）</td>
<td>A*</td>
<td>&lt;�((�+�)log⁡�)<em>O</em>((<em>m</em>+<em>n</em>)log<em>n</em>)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>双向广搜</td>
<td>&lt;�((�+�)log⁡�)<em>O</em>((<em>m</em>+<em>n</em>)log<em>n</em>)</td>
</tr>
<tr>
<td></td>
<td></td>
<td>贪心最优搜索</td>
<td>&lt;�(�+�)<em>O</em>(<em>m</em>+<em>n</em>)</td>
</tr>
<tr>
<td>一个起点到其他所有点</td>
<td>无边权（或边权为 1）</td>
<td>BFS</td>
<td>�(�+�)<em>O</em>(<em>m</em>+<em>n</em>)</td>
</tr>
<tr>
<td></td>
<td>非负数</td>
<td>Dijkstra(堆优化优先队列)</td>
<td>�((�+�)log⁡�)<em>O</em>((<em>m</em>+<em>n</em>)log<em>n</em>)</td>
</tr>
<tr>
<td></td>
<td>允许有负数</td>
<td>SPFA</td>
<td>&lt;�(��)<em>O</em>(<em>m**n</em>)</td>
</tr>
<tr>
<td>所有点对之间</td>
<td>允许有负数</td>
<td>Floyd-Warshall</td>
<td>�(�3)<em>O</em>(<em>n</em>3)</td>
</tr>
</tbody></table>
<p>什么算法也不能解决存在负环图的最短路的问题！最多是判断是否存在，或者找到负环。</p>
<p>网站推荐：<a target="_blank" rel="noopener" href="https://csacademy.com/app/graph_editor/?tdsourcetag=s_pctim_aiomsg">CSAcademy Graph Editor</a></p>
<p><img src="/./../imgs/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/5c77aaf44a27ba24fd4dfee6aa36a8ce-0.png" alt="图片描述"></p>
<p>方便图论的学习。</p>
<h3 id="Floyd-算法"><a href="#Floyd-算法" class="headerlink" title="Floyd 算法"></a>Floyd 算法</h3><ul>
<li>最简单的最短路径算法，代码仅有 44 行</li>
<li>存图：最简单的矩阵存图</li>
<li>易懂，比暴力的搜索更简单易懂。</li>
<li>效率不高，不能用于大图在某些场景下有自己的优势，难以替代。能做传递闭包问题（离散数学）</li>
</ul>
<figure class="hljs highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//java 和 c++</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">1</span>; k&lt;=n; k++)         <span class="comment">//floyd的三重循环</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=n; j++)      <span class="comment">// k循环在i、j循环外面</span></span><br><span class="line">            dp[i][j] = min(dp[i][j], dp[i][k] + dp[k][j]);</span><br><span class="line"><span class="meta">#python</span></span><br><span class="line"><span class="keyword">for</span> k in <span class="title function_">range</span><span class="params">(<span class="number">1</span>, n+<span class="number">1</span>)</span>: <span class="meta">#floyd的三重循环</span></span><br><span class="line">    <span class="keyword">for</span> i in <span class="title function_">range</span><span class="params">(<span class="number">1</span>, n+<span class="number">1</span>)</span>:</span><br><span class="line">        <span class="keyword">for</span> j in <span class="title function_">range</span><span class="params">(<span class="number">1</span>, n+<span class="number">1</span>)</span>: <span class="meta"># k循环在i、j循环外面</span></span><br><span class="line">            dp[i][j] = min(dp[i][j], dp[i][k] + dp[k][j])</span><br></pre></td></tr></table></figure>

<p><code>Floyd算法</code>：<code>多源</code>最短路算法，一次计算能得到图中每一对结点之间（<code>多对多</code>）的最短路径。 <code>Dijkstra</code>、<code>Bellman-Ford</code>、<code>SPFA</code>算法：<code>单源</code>最短路径算法（<code>Single source shortest path algorithm</code>），一次计算能得到一个起点到其他所有点（<code>一对多</code>）的最短路径。在截止目前的蓝桥杯大赛中，<code>Floyd</code>算法是最常见的最短路径算法。 以上统计包括国赛和省赛，所以另外两种仍然要进行学习。</p>
<h4 id="Floyd-算法思想：动态规划"><a href="#Floyd-算法思想：动态规划" class="headerlink" title="Floyd 算法思想：动态规划"></a>Floyd 算法思想：动态规划</h4><p>下面为 <code>Floyd</code> 算法的原理，不看背代码也可以。</p>
<ul>
<li>动态规划：求图上两点 <code>i</code>、<code>j</code> 之间的最短距离，按“从小图到全图”的步骤，在逐步扩大图的过程中计算和更新最短路。</li>
<li>定义状态：<code>dp[k][i][j]，i、j、k</code>是点的编号，范围 <code>1 ~ n</code>。状态<code>dp[k][i][j]</code>表示在包含 <code>1 ~ k</code> 点的子图上，点对 <code>i、j</code> 之间的最短路。</li>
<li>状态转移方程：从子图 <code>1 ~ k-1</code> 扩展到子图 <code>1 ~ k</code>��[�][�][�]&#x3D;���(��[�−1][�][�],��[�−1][�][�]+��[�−1][�][�])<em>d**p</em>[<em>k</em>][<em>i</em>][<em>j</em>]&#x3D;<em>m<strong>i</strong>n</em>(<em>d**p</em>[<em>k</em>−1][<em>i</em>][<em>j</em>],<em>d**p</em>[<em>k</em>−1][<em>i</em>][<em>k</em>]+<em>d**p</em>[<em>k</em>−1][<em>k</em>][<em>j</em>])</li>
</ul>
<p>首先是包含 <code>1 ~ k-1</code> 点的子图。 ��[�−1][�][�]<em>d**p</em>[<em>k</em>−1][<em>i</em>][<em>j</em>]：不包含 <code>k</code> 点子图内的点对 <code>i、j</code> 的最短路； ��[�−1][�][�]+��[�−1][�][�]<em>d**p</em>[<em>k</em>−1][<em>i</em>][<em>k</em>]+<em>d**p</em>[<em>k</em>−1][<em>k</em>][<em>j</em>]：经过 k 点的新路径的长度，即这条路径从 <code>i</code> 出发，先到 <code>k</code>，再从 <code>k</code> 到终点 <code>j</code>。 比较：不经过 <code>k</code> 的最短路径��[�−1][�][�]<em>d**p</em>[<em>k</em>−1][<em>i</em>][<em>j</em>]和经过 <code>k</code> 的新路径，较小者就是新的��[�][�][�]<em>d**p</em>[<em>k</em>][<em>i</em>][<em>j</em>]。</p>
<p>所以 <code>Floyd</code> 的原理就是每次引入一个新的点，用它去更新其他点的最短距离。</p>
<p><code>k</code> 从 <code>1</code> 逐步扩展到 <code>n</code>：最后得到的��[�][�][�]<em>d**p</em>[<em>n</em>][<em>i</em>][<em>j</em>]是点对 <code>i、j</code> 之间的最短路径长度。 初值��[0][�][�]<em>d**p</em>[0][<em>i</em>][<em>j</em>]：若 <code>i、j</code> 是直连的，就是它们的边长；若不直连，赋值为无穷大。 <code>i、j</code> 是任意点对：计算结束后得到了所有点对之间的最短路。</p>
<p>��[�][�][�]&#x3D;���(��[�−1][�][�],��[�−1][�][�]+��[�−1][�][�])<em>d**p</em>[<em>k</em>][<em>i</em>][<em>j</em>]&#x3D;<em>m<strong>i</strong>n</em>(<em>d**p</em>[<em>k</em>−1][<em>i</em>][<em>j</em>],<em>d**p</em>[<em>k</em>−1][<em>i</em>][<em>k</em>]+<em>d**p</em>[<em>k</em>−1][<em>k</em>][<em>j</em>]) 用滚动数组简化： ��[�][�]&#x3D;���(��[�][�],��[�][�]+��[�][�])<em>d**p</em>[<em>i</em>][<em>j</em>]&#x3D;<em>m<strong>i</strong>n</em>(<em>d**p</em>[<em>i</em>][<em>j</em>],<em>d**p</em>[<em>i</em>][<em>k</em>]+<em>d**p</em>[<em>k</em>][<em>j</em>])</p>
<p><strong>特点：</strong></p>
<ul>
<li>在一次计算后求得所有结点之间的最短距离。</li>
<li>代码极其简单，是最简单的最短路算法。</li>
<li>效率低下，计算复杂度是 �(�3)<em>O</em>(<em>n</em>3)，只能用于 �&lt;300<em>n</em>&lt;300 的小规模的图。</li>
<li>存图用邻接矩阵 <code>dp[][]</code> 。因为 <code>Floyd</code> 算法计算的结果是所有点对之间的最短路，本身就需要 <code>n^2</code> 的空间，用矩阵存储最合适。</li>
<li>能判断负圈。 负圈：若图中有权值为负的边，某个经过这个负边的环路，所有边长相加的总长度也是负数，这就是负圈。在这个负圈上每绕一圈，总长度就更小，从而陷入在负圈上兜圈子的死循环。 <code>Floyd</code> 算法很容易判断负圈，只要在算法运行过程出现任意一个 <code>dp[i][i] &lt; 0</code> 就说明有负圈。因为 <code>dp[i][i]</code> 是从 <code>i</code> 出发，经过其他中转点绕一圈回到自己的最短路径，如果小于零，就存在负圈。</li>
</ul>
<h3 id="Dijkstra-算法"><a href="#Dijkstra-算法" class="headerlink" title="Dijkstra 算法"></a>Dijkstra 算法</h3><ul>
<li>Dijkstra：单源最短路径问题。</li>
<li>优点：非常高效而且稳定。</li>
<li>缺点：只能处理不含有负权边的图。</li>
<li>思路：贪心思想+优先队列。</li>
</ul>
<h4 id="算法思想"><a href="#算法思想" class="headerlink" title="算法思想"></a>算法思想</h4><p><code>Dijkstra</code> 算法算是贪心思想实现的，首先把起点到所有点的距离存下来找个最短的，然后松弛一次再找出最短的，所谓的松弛操作就是，遍历一遍看通过刚刚找到的距离最短的点作为中转站会不会更近，如果更近了就更新距离，这样把所有的点找遍之后就存下了起点到其他所有点的最短距离。</p>
<p><strong>为什么是每次都是找最小的？</strong></p>
<p>因为最小边的不会被其它的点松弛，只有可能最小边去松弛别人。 如果存在一个点 �<em>K</em> 能够松弛 ��<em>a**b</em> 的话那么一定有 ��<em>a**k</em> 距离加上 ��<em>k**b</em> 的距离小于 ��<em>a**b</em>，已知 ��<em>a**b</em> 最短，所以不存在 ��+��&lt;��<em>a**k</em>+<em>k**b</em>&lt;<em>a**b</em>。</p>
<p><code>Dijkstra</code> 算法应用了贪心法的思想，即“抄近路走，肯定能找到最短路径”。</p>
<p>算法高效稳定：</p>
<ul>
<li><code>Dijkstra</code> 的每次迭代，只需要检查上次已经确定最短路径的那些结点的邻居，检查范围很小，算法是高效的；</li>
<li>每次迭代，都能得到至少一个结点的最短路径，算法是稳定的</li>
</ul>
<p>优先队列实现：</p>
<ul>
<li>每次往队列中放新数据时，按从小到大的顺序放，采用小顶堆的方式，复杂度是 �(����)<em>O</em>(<em>l<strong>o</strong>g**n</em>)，保证最小的数总在最前面；</li>
<li>找最小值，直接取 <code>B</code> 的第一个数，复杂度是 �(1)<em>O</em>(1)。</li>
<li>复杂度：用优先队列时，<code>Dijkstra</code> 算法的复杂度是 �(�����)<em>O</em>(<em>m<strong>l</strong>o<strong>g</strong>n</em>)，是最高效的最短路算法。</li>
</ul>
<p>维护两个集合：已确定最短路径的结点集合 <code>A</code>、这些结点向外扩散的邻居结点集合 <code>B</code>。</p>
<ol>
<li>把起点 <code>s</code> 放到 <code>A</code> 中，把 <code>s</code> 所有的邻居放到 <code>B</code> 中。此时，邻居到 <code>s</code> 的距离就是直连距离。</li>
<li>从 <code>B</code> 中找出距离起点 <code>s</code> 最短的结点 <code>u</code>，放到 <code>A</code> 中。</li>
<li>把 <code>u</code> 所有的新邻居放到 <code>B</code> 中。显然，<code>u</code> 的每一条边都连接了一个邻居，每个新邻居都要加进去。其中 <code>u</code> 的一个新邻居 <code>v</code>，它到 <code>s</code> 的距离 <code>dis(s, v)</code> 等于 <code>dis(s, u) + dis(u, v)</code>。</li>
<li>重复(2)、(3)，直到 <code>B</code> 为空时，结束。</li>
</ol>
<p><strong>Dijkstra 的局限性是边的权值不能为负数：</strong></p>
<p>Dijkstra 基于 <code>BFS</code>，计算过程是从起点 <code>s</code> 逐步往外扩散的过程，每扩散一次就用贪心得到到一个点的最短路。 扩散要求路径越来越长，如果遇到一个负权边，会导致路径变短，使扩散失效。</p>
<p>Dijkstra 模板如下：</p>
<figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">long</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>LL;</span><br><span class="line"><span class="comment">//这样定义INF的好处是: INF &lt;= INF+x</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N= <span class="number">3e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> from, to; <span class="type">long</span> <span class="type">long</span> w; <span class="comment">//起点，终点，权值。起点from并没有用到，e[i]的i就是from</span></span><br><span class="line">    <span class="built_in">edge</span>(<span class="type">int</span> a, <span class="type">int</span> b,<span class="type">long</span> <span class="type">long</span> c)&#123;from=a; to=b; w=c;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;edge&gt;e[N];          <span class="comment">//用于存储图</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">s_node</span>&#123;</span><br><span class="line">    <span class="type">int</span> id; <span class="type">long</span> <span class="type">long</span> n_dis;   <span class="comment">//id：结点；n_dis：这个结点到起点的距离</span></span><br><span class="line">    <span class="built_in">s_node</span>(<span class="type">int</span> b,<span class="type">long</span> <span class="type">long</span> c)&#123;id=b; n_dis=c;&#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> s_node &amp; a) <span class="type">const</span></span><br><span class="line">    &#123; <span class="keyword">return</span> n_dis &gt; a.n_dis;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> pre[N];                                <span class="comment">//记录前驱结点，用于生成路径</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print_path</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;            <span class="comment">//打印从s到t的最短路</span></span><br><span class="line">    <span class="keyword">if</span>(s==t)&#123; <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, s); <span class="keyword">return</span>; &#125;  <span class="comment">//打印起点</span></span><br><span class="line">    <span class="built_in">print_path</span>(s, pre[t]);                 <span class="comment">//先打印前一个点</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t);                      <span class="comment">//后打印当前点。最后打印的是终点t</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span>  dis[N];         <span class="comment">//记录所有结点到起点的距离</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">1</span>;             <span class="comment">//起点s是1</span></span><br><span class="line">    <span class="type">bool</span> done[N]; <span class="comment">//done[i]=true表示到结点i的最短路径已经找到</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;dis[i]=INF; done[i]=<span class="literal">false</span>; &#125;    <span class="comment">//初始化</span></span><br><span class="line">    dis[s]=<span class="number">0</span>;                           <span class="comment">//起点到自己的距离是0</span></span><br><span class="line">    priority_queue &lt;s_node&gt; Q;          <span class="comment">//优先队列，存结点信息</span></span><br><span class="line">    Q.<span class="built_in">push</span>(<span class="built_in">s_node</span>(s, dis[s]));          <span class="comment">//起点进队列</span></span><br><span class="line">    <span class="keyword">while</span> (!Q.<span class="built_in">empty</span>())   &#123;</span><br><span class="line">        s_node u = Q.<span class="built_in">top</span>();             <span class="comment">//pop出距起点s距离最小的结点u</span></span><br><span class="line">        Q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(done[u.id])  <span class="keyword">continue</span>;       <span class="comment">//丢弃已经找到最短路径的结点。即集合A中的结点            </span></span><br><span class="line">        done[u.id]= <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;e[u.id].<span class="built_in">size</span>(); i++) &#123;  <span class="comment">//检查结点u的所有邻居</span></span><br><span class="line">            edge y = e[u.id][i];         <span class="comment">//u.id的第i个邻居是y.to</span></span><br><span class="line">            <span class="keyword">if</span>(done[y.to])  <span class="keyword">continue</span>;    <span class="comment">//丢弃已经找到最短路径的邻居结点                </span></span><br><span class="line">            <span class="keyword">if</span> (dis[y.to] &gt; y.w + u.n_dis) &#123;</span><br><span class="line">                dis[y.to] = y.w + u.n_dis;</span><br><span class="line">                Q.<span class="built_in">push</span>(<span class="built_in">s_node</span>(y.to, dis[y.to]));  <span class="comment">//扩展新的邻居，放到优先队列中</span></span><br><span class="line">                pre[y.to]=u.id;  <span class="comment">//如果有需要，记录路径</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// print_path(s,n);          //如果有需要，打印路径: 起点1，终点n</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)    e[i].<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="type">int</span> u,v,w;  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%lld&quot;</span>,&amp;u,&amp;v,&amp;w);</span><br><span class="line">        e[u].<span class="built_in">push_back</span>(<span class="built_in">edge</span>(u,v,w));</span><br><span class="line">     <span class="comment">// e[v].push_back(edge(v,u,w));    //本题是单向道路</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dijkstra</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(dis[i]&gt;=INF)  cout&lt;&lt;<span class="string">&quot;-1 &quot;</span>;</span><br><span class="line">        <span class="keyword">else</span>   <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, dis[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="type">static</span> <span class="keyword">final</span> <span class="type">long</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>L;</span><br><span class="line">    <span class="type">static</span> <span class="keyword">final</span> <span class="type">int</span> N = <span class="number">300005</span>;</span><br><span class="line">    <span class="type">static</span> ArrayList&lt;Edge&gt;[] e = <span class="keyword">new</span> ArrayList[N];</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> n, m;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span>[] pre = <span class="keyword">new</span> <span class="type">int</span>[N];</span><br><span class="line">    <span class="type">static</span> <span class="type">long</span>[] dis = <span class="keyword">new</span> <span class="type">long</span>[N];</span><br><span class="line">    <span class="type">static</span> boolean[] done = <span class="keyword">new</span> boolean[N];</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="keyword">class</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> from, to;</span><br><span class="line">        <span class="type">long</span> w;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Edge</span>(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">long</span> c) &#123;</span><br><span class="line">            from = a;</span><br><span class="line">            to = b;</span><br><span class="line">            w = c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="keyword">class</span> <span class="title class_">SNode</span> implements Comparable&lt;SNode&gt; &#123;</span><br><span class="line">        <span class="type">int</span> id;</span><br><span class="line">        <span class="type">long</span> n_dis;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">SNode</span>(<span class="type">int</span> b, <span class="type">long</span> c) &#123;</span><br><span class="line">            id = b;</span><br><span class="line">            n_dis = c;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="type">int</span> <span class="title">compareTo</span><span class="params">(SNode o)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Long.<span class="built_in">compare</span>(n_dis, o.n_dis);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">printPath</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s == t) &#123;</span><br><span class="line">            System.out.<span class="built_in">print</span>(s + <span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printPath</span>(s, pre[t]);</span><br><span class="line">        System.out.<span class="built_in">print</span>(t + <span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> s = <span class="number">1</span>;</span><br><span class="line">        PriorityQueue&lt;SNode&gt; Q = <span class="keyword">new</span> PriorityQueue&lt;&gt;();</span><br><span class="line">        Arrays.<span class="built_in">fill</span>(dis, INF);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        Q.<span class="built_in">offer</span>(<span class="keyword">new</span> <span class="built_in">SNode</span>(s, dis[s]));</span><br><span class="line">        <span class="keyword">while</span> (!Q.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">            SNode u = Q.<span class="built_in">poll</span>();</span><br><span class="line">            <span class="keyword">if</span> (done[u.id])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            done[u.id] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (Edge y : e[u.id]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (done[y.to])</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (dis[y.to] &gt; y.w + u.n_dis) &#123;</span><br><span class="line">                    dis[y.to] = y.w + u.n_dis;</span><br><span class="line">                    Q.<span class="built_in">offer</span>(<span class="keyword">new</span> <span class="built_in">SNode</span>(y.to, dis[y.to]));</span><br><span class="line">                    pre[y.to] = u.id;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// printPath(s, n);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(String[] args)</span> throws Exception </span>&#123;</span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> <span class="built_in">BufferedReader</span>(<span class="keyword">new</span> <span class="built_in">InputStreamReader</span>(System.in));</span><br><span class="line">        StringTokenizer st = <span class="keyword">new</span> <span class="built_in">StringTokenizer</span>(br.<span class="built_in">readLine</span>());</span><br><span class="line">        n = Integer.<span class="built_in">parseInt</span>(st.<span class="built_in">nextToken</span>());</span><br><span class="line">        m = Integer.<span class="built_in">parseInt</span>(st.<span class="built_in">nextToken</span>());</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            e[i] = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            st = <span class="keyword">new</span> <span class="built_in">StringTokenizer</span>(br.<span class="built_in">readLine</span>());</span><br><span class="line">            <span class="type">int</span> u = Integer.<span class="built_in">parseInt</span>(st.<span class="built_in">nextToken</span>());</span><br><span class="line">            <span class="type">int</span> v = Integer.<span class="built_in">parseInt</span>(st.<span class="built_in">nextToken</span>());</span><br><span class="line">            <span class="type">long</span> w = Long.<span class="built_in">parseLong</span>(st.<span class="built_in">nextToken</span>());</span><br><span class="line">            e[u].<span class="built_in">add</span>(<span class="keyword">new</span> <span class="built_in">Edge</span>(u, v, w));</span><br><span class="line">            <span class="comment">// e[v].add(new Edge(v, u, w)); //本题是单向道路</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">dijkstra</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dis[i] &gt;= INF)</span><br><span class="line">                System.out.<span class="built_in">print</span>(<span class="string">&quot;-1 &quot;</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                System.out.<span class="built_in">print</span>(dis[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line">INF = <span class="number">0x3f3f3f3f3f3f3f3f</span></span><br><span class="line">N = <span class="number">300002</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Edge:</span><br><span class="line">    def __init__(self, fr, to, w):</span><br><span class="line">        self.fr = fr</span><br><span class="line">        self.to = to</span><br><span class="line">        self.w = w</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> SNode:</span><br><span class="line">    def __init__(self, id, n_dis):</span><br><span class="line">        self.id = id</span><br><span class="line">        self.n_dis = n_dis</span><br><span class="line"></span><br><span class="line">    def __lt__(self, other):</span><br><span class="line">        <span class="keyword">return</span> self.n_dis &lt; other.n_dis</span><br><span class="line"></span><br><span class="line">def <span class="built_in">print_path</span>(s, t):</span><br><span class="line">    <span class="keyword">if</span> s == t:</span><br><span class="line">        <span class="built_in">print</span>(s, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print_path</span>(s, pre[t])</span><br><span class="line">    <span class="built_in">print</span>(t, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">dijkstra</span>():</span><br><span class="line">    s = <span class="number">1</span></span><br><span class="line">    done = [False] * N</span><br><span class="line">    dis = [INF] * N</span><br><span class="line">    pre = [<span class="number">-1</span>] * N</span><br><span class="line">    dis[s] = <span class="number">0</span></span><br><span class="line">    pq = []</span><br><span class="line">    heapq.<span class="built_in">heappush</span>(pq, <span class="built_in">SNode</span>(s, dis[s]))</span><br><span class="line">    <span class="keyword">while</span> pq:</span><br><span class="line">        u = heapq.<span class="built_in">heappop</span>(pq)</span><br><span class="line">        <span class="keyword">if</span> done[u.id]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        done[u.id] = True</span><br><span class="line">        <span class="keyword">for</span> y in e[u.id]:</span><br><span class="line">            <span class="keyword">if</span> done[y.to]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> dis[y.to] &gt; y.w + u.n_dis:</span><br><span class="line">                dis[y.to] = y.w + u.n_dis</span><br><span class="line">                heapq.<span class="built_in">heappush</span>(pq, <span class="built_in">SNode</span>(y.to, dis[y.to]))</span><br><span class="line">                pre[y.to] = u.id</span><br><span class="line">    <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> dis[i] &gt;= INF:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-1&quot;</span>, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(dis[i], end=<span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line">n, m = <span class="built_in">map</span>(<span class="type">int</span>, <span class="built_in">input</span>().<span class="built_in">split</span>())</span><br><span class="line">e = [[] <span class="keyword">for</span> _ in <span class="built_in">range</span>(N)]</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(m):</span><br><span class="line">    u, v, w = <span class="built_in">map</span>(<span class="type">int</span>, <span class="built_in">input</span>().<span class="built_in">split</span>())</span><br><span class="line">    e[u].<span class="built_in">append</span>(<span class="built_in">Edge</span>(u, v, w))</span><br><span class="line"></span><br><span class="line"><span class="built_in">dijkstra</span>()</span><br></pre></td></tr></table></figure>

<h3 id="Bellman-Ford-算法"><a href="#Bellman-Ford-算法" class="headerlink" title="Bellman-Ford 算法"></a>Bellman-Ford 算法</h3><p>BFS 的扩散思想，每个人都去问自己的相邻节点到 <code>S</code> 点的距离最近是多少。</p>
<p>第一轮至少有一个点得到了到 <code>S</code> 的最短距离，即与 <code>S</code> 相邻的节点，标记为 <code>T1</code></p>
<p>重复以上操作，那么必然至少又有一个节点找到了与 <code>S</code> 的最短距离，即与 <code>T1</code> 相邻的节点，标记为 <code>T2</code></p>
<p><strong>一共需要几轮操作？</strong></p>
<p>每一轮操作，都至少有一个新的结点得到了到 <code>S</code> 的最短路径。所以，最多只需要 <code>n</code> 轮操作，就能完成 <code>n</code> 个结点。在每一轮操作中，需要检查所有 <code>m</code> 个边，更新最短距离。</p>
<p>Bellman-Ford 算法的复杂度：<code>O(nm)</code>。</p>
<p><strong>Bellman-Ford 能判断负圈：</strong></p>
<p>没有负圈时，只需要 <code>n</code> 轮就结束。</p>
<p>如果超过 <code>n</code> 轮，最短路径还有变化，那么肯定有负圈。</p>
<h4 id="SPFA-算法"><a href="#SPFA-算法" class="headerlink" title="SPFA 算法"></a>SPFA 算法</h4><p>队列优化版的 Bellman-Ford</p>
<p>SPFA &#x3D; 队列处理+Bellman-Ford。</p>
<p>Bellman-Ford 算法有很多低效或无效的操作。其核心内容，是在每一轮操作中，更新所有结点到起点 <code>S</code> 的最短距离。 计算和调整一个结点 <code>U</code> 到 <code>S</code> 的最短距离后，如果紧接着调整 <code>U</code> 的邻居结点，这些邻居肯定有新的计算结果；而如果漫无目的地计算不与 <code>U</code> 相邻的结点，很可能毫无变化，所以这些操作是低效的。</p>
<p><strong>改进：</strong> 计算结点 <code>U</code> 之后，下一步只计算和调整它的邻居，能加快收敛的过程。 这些步骤用队列进行操作，这就是 SPFA。</p>
<p>（1）起点 <code>S</code> 入队，计算它所有邻居到 <code>S</code> 的最短距离。把 <code>S</code> 出队，状态有更新的邻居入队，没更新的不入队。 （2）现在队列的头部是 <code>S</code> 的一个邻居 <code>U</code>。弹出 <code>U</code>，更新它所有邻居的状态，把其中有状态变化的邻居入队列。 （3）继续以上过程，直到队列空。这也意味着，所有结点的状态都不再更新。最后的状态就是到起点 <code>S</code> 的最短路径。</p>
<p>弹出 <code>U</code> 之后，在后面的计算中，<code>U</code> 可能会再次更新状态（后来发现，<code>U</code> 借道别的结点去 <code>S</code>，路更近）。所以，<code>U</code> 可能需要重新入队列。 有可能只有很少结点重新进入队列，也有可能很多。这取决于图的特征。</p>
<p><strong>所以，SPFA 是不稳定的,所以根据题目的类型，我们要选择合适的算法。</strong></p>
<p><strong>SPFA 模板如下：</strong></p>
<figure class="hljs highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">long</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e3</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> to;    <span class="type">long</span> <span class="type">long</span> w;</span><br><span class="line">    <span class="built_in">edge</span>(<span class="type">int</span> tt,<span class="type">long</span> <span class="type">long</span> ww) &#123;to = tt; w = ww;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> dist[N];</span><br><span class="line"><span class="type">int</span> inq[N];</span><br><span class="line">vector&lt;edge&gt; e[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dist,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dist));</span><br><span class="line">    dist[s] = <span class="number">0</span>;      <span class="comment">//起点到自己的距离是0</span></span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s);        <span class="comment">//从s开始，s进队列</span></span><br><span class="line">    inq[s] = <span class="number">1</span>;       <span class="comment">//起点在队列中</span></span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        inq[u] = <span class="number">0</span>;   <span class="comment">//u已经不在队列中</span></span><br><span class="line">        <span class="keyword">if</span>(dist[u] == INF)     <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; e[u].<span class="built_in">size</span>();i++) &#123;   <span class="comment">//遍历u的邻居</span></span><br><span class="line">            <span class="type">int</span> v = e[u][i].to;</span><br><span class="line">            <span class="type">long</span> <span class="type">long</span> w = e[u][i].w;</span><br><span class="line">            <span class="keyword">if</span>(dist[v] &gt; dist[u]+w) &#123;         <span class="comment">//u的第i个邻居v，它借道u，到s更近</span></span><br><span class="line">                dist[v] = dist[u]+w;          <span class="comment">//更新邻居v到s的距离</span></span><br><span class="line">                <span class="keyword">if</span>(!inq[v]) &#123;      <span class="comment">//邻居v更新状态了，但v不在队列中，放进队列</span></span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                    inq[v] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m,s;cin&gt;&gt;n&gt;&gt;m&gt;&gt;s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= m;i++)    &#123;</span><br><span class="line">        <span class="type">int</span> u,v; <span class="type">long</span> <span class="type">long</span> w;</span><br><span class="line">        cin&gt;&gt;u&gt;&gt;v&gt;&gt;w;</span><br><span class="line">        e[u].<span class="built_in">push_back</span>(<span class="built_in">edge</span>(v,w));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">spfa</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n;i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(dist[i]==INF)  cout &lt;&lt; <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">else</span>              cout &lt;&lt; dist[i];</span><br><span class="line">        <span class="keyword">if</span>(i != n)        cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="keyword">else</span>              cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="type">static</span> <span class="keyword">final</span> <span class="type">long</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>L;</span><br><span class="line">    <span class="type">static</span> <span class="keyword">final</span> <span class="type">int</span> N = <span class="number">5010</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="type">long</span>[] dist = <span class="keyword">new</span> <span class="type">long</span>[N];</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span>[] inq = <span class="keyword">new</span> <span class="type">int</span>[N];</span><br><span class="line">    <span class="type">static</span> List&lt;edge&gt;[] e = <span class="keyword">new</span> ArrayList[N];</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="keyword">class</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> to;</span><br><span class="line">        <span class="type">long</span> w;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">edge</span><span class="params">(<span class="type">int</span> tt, <span class="type">long</span> ww)</span> </span>&#123;</span><br><span class="line">            to = tt;</span><br><span class="line">            w = ww;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span> </span>&#123;</span><br><span class="line">        Arrays.<span class="built_in">fill</span>(dist, INF);</span><br><span class="line">        dist[s] = <span class="number">0</span>;</span><br><span class="line">        Queue&lt;Integer&gt; q = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">        q.<span class="built_in">add</span>(s);</span><br><span class="line">        inq[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">isEmpty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> u = q.<span class="built_in">poll</span>();</span><br><span class="line">            inq[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (dist[u] == INF) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; e[u].<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">                <span class="type">int</span> v = e[u].<span class="built_in">get</span>(i).to;</span><br><span class="line">                <span class="type">long</span> w = e[u].<span class="built_in">get</span>(i).w;</span><br><span class="line">                <span class="keyword">if</span> (dist[v] &gt; dist[u] + w) &#123;</span><br><span class="line">                    dist[v] = dist[u] + w;</span><br><span class="line">                    <span class="keyword">if</span> (inq[v] == <span class="number">0</span>) &#123;</span><br><span class="line">                        q.<span class="built_in">add</span>(v);</span><br><span class="line">                        inq[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="type">static</span> <span class="type">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner in = <span class="keyword">new</span> <span class="built_in">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> n = in.<span class="built_in">nextInt</span>();</span><br><span class="line">        <span class="type">int</span> m = in.<span class="built_in">nextInt</span>();</span><br><span class="line">        <span class="type">int</span> s = in.<span class="built_in">nextInt</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            e[i] = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="type">int</span> u = in.<span class="built_in">nextInt</span>();</span><br><span class="line">            <span class="type">int</span> v = in.<span class="built_in">nextInt</span>();</span><br><span class="line">            <span class="type">long</span> w = in.<span class="built_in">nextLong</span>();</span><br><span class="line">            e[u].<span class="built_in">add</span>(<span class="keyword">new</span> <span class="built_in">edge</span>(v, w));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">spfa</span>(s);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dist[i] == INF) System.out.<span class="built_in">print</span>(<span class="string">&quot;-1 &quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> System.out.<span class="built_in">print</span>(dist[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line">INF = <span class="number">0x3f3f3f3f3f3f3f3f</span></span><br><span class="line">N = <span class="number">5010</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Edge:</span><br><span class="line">    def __init__(self, to, w):</span><br><span class="line">        self.to = to</span><br><span class="line">        self.w = w</span><br><span class="line"></span><br><span class="line">dist = [INF] * N</span><br><span class="line">inq = [<span class="number">0</span>] * N</span><br><span class="line">e = [[] <span class="keyword">for</span> _ in <span class="built_in">range</span>(N)]</span><br><span class="line"></span><br><span class="line">def <span class="built_in">spfa</span>(s):</span><br><span class="line">    global dist</span><br><span class="line">    global inq</span><br><span class="line">    dist = [INF] * N</span><br><span class="line">    dist[s] = <span class="number">0</span></span><br><span class="line">    q = []</span><br><span class="line">    heapq.<span class="built_in">heappush</span>(q, s)</span><br><span class="line">    inq[s] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> q:</span><br><span class="line">        u = heapq.<span class="built_in">heappop</span>(q)</span><br><span class="line">        inq[u] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> dist[u] == INF:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="built_in">len</span>(e[u])):</span><br><span class="line">            v = e[u][i].to</span><br><span class="line">            w = e[u][i].w</span><br><span class="line">            <span class="keyword">if</span> dist[v] &gt; dist[u] + w:</span><br><span class="line">                dist[v] = dist[u] + w</span><br><span class="line">                <span class="keyword">if</span> inq[v] == <span class="number">0</span>:</span><br><span class="line">                    heapq.<span class="built_in">heappush</span>(q, v)</span><br><span class="line">                    inq[v] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">n, m, s = <span class="built_in">map</span>(<span class="type">int</span>, <span class="built_in">input</span>().<span class="built_in">split</span>())</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(m):</span><br><span class="line">    u, v, w = <span class="built_in">map</span>(<span class="type">int</span>, <span class="built_in">input</span>().<span class="built_in">split</span>())</span><br><span class="line">    e[u].<span class="built_in">append</span>(<span class="built_in">Edge</span>(v, w))</span><br><span class="line"><span class="built_in">spfa</span>(s)</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> dist[i] == INF:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;-1&quot;</span>, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(dist[i], end=<span class="string">&quot; &quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Dijkstra：适用于权值为非负的图的单源最短路径，用斐波那契堆的复杂度 <code>O(E+VlgV)</code> BellmanFord：适用于权值有负值的图的单源最短路径，并且能够检测负圈，复杂度 <code>O(VE)</code> SPFA：适用于权值有负值，且没有负圈的图的单源最短路径。论文中的复杂度为 <code>O(kE)</code>, 其中 <code>k</code> 为每个节点进入队列的次数，且 <code>k</code> 一般 <code>&lt;=2</code>，但此处的复杂度证明是有问题的，其实 SPFA 的最坏情况应该是 <code>O(VE)</code>。 Floyd：每对节点之间的最短路径。</p>
<p><strong>所以：</strong></p>
<p>单源最短路 (1)当权值为非负时，用 <code>Dijkstra</code>。 (2)当权值有负值，且没有负圈，则用 <code>SPFA</code>。<code>SPFA</code> 能检测负圈，但是不能输出负圈。 (3)当权值有负值，而且可能存在负圈需要输出，则用 <code>BellmanFord</code>。能够检测并输出负圈。 多源最短路使用 <code>Floyd</code></p>
<h2 id="最小生成树"><a href="#最小生成树" class="headerlink" title="最小生成树"></a>最小生成树</h2><p>在无向图中，连通而且不含有圈（环路）的图，称为树。 最小生成树 MST：一个有 <code>n</code> 个结点的连通图的生成树是原图的极小连通子图，包含原图中的所有 <code>n</code> 个结点，并且边的权值之和最小。</p>
<h3 id="Prim-算法"><a href="#Prim-算法" class="headerlink" title="Prim 算法"></a>Prim 算法</h3><p>对点进行贪心操作：“最近的邻居一定在 MST 上”。 从任意一个点 <code>u</code> 开始，把距离它最近的点 <code>v</code> 加入到 MST 中；下一步，把距离 {<code>u, v</code>} 最近的点 <code>w</code> 加入到 MST 中；继续这个过程，直到所有点都在 MST 中。</p>
<figure class="hljs highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1005</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; demo;</span><br><span class="line"><span class="type">int</span> closest[MAXN],lowcost[MAXN],m,n;<span class="comment">//m为节点的个数，n为边的数量</span></span><br><span class="line"><span class="type">int</span> G[MAXN][MAXN];<span class="comment">//邻接矩阵</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">prim</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        lowcost[i] = INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        closest[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    closest[<span class="number">0</span>] = <span class="number">-1</span>;<span class="comment">//加入第一个点，-1表示该点在集合U中，否则在集合V中</span></span><br><span class="line">    <span class="type">int</span> num = <span class="number">0</span>,ans = <span class="number">0</span>,e = <span class="number">0</span>;<span class="comment">//e为最新加入集合的点</span></span><br><span class="line">    <span class="keyword">while</span> (num &lt; m<span class="number">-1</span>)<span class="comment">//加入m-1条边</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> micost = INF,miedge = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">        <span class="keyword">if</span>(closest[i] != <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> temp = G[e][i];</span><br><span class="line">            <span class="keyword">if</span>(temp &lt; lowcost[i])</span><br><span class="line">            &#123;</span><br><span class="line">                lowcost[i] = temp;</span><br><span class="line">                closest[i] = e;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(lowcost[i] &lt; micost)</span><br><span class="line">            micost = lowcost[miedge=i];</span><br><span class="line">        &#125;</span><br><span class="line">        ans += micost;</span><br><span class="line">        demo.push_back(micost);</span><br><span class="line">        closest[e = miedge] = <span class="number">-1</span>;</span><br><span class="line">        num++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;m, &amp;n);</span><br><span class="line">    <span class="built_in">memset</span>(G,INF,<span class="keyword">sizeof</span>(G));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="type">int</span> a,b,c;</span><br><span class="line">       <span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line"></span><br><span class="line">       G[b][a]=G[a][b]=c;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;prim()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m<span class="number">-1</span>;i++) <span class="built_in">cout</span>&lt;&lt;demo[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Main</span> &#123;</span></span><br><span class="line">    private <span class="type">static</span> final <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">    private <span class="type">static</span> final <span class="type">int</span> MAXN = <span class="number">1005</span>;</span><br><span class="line">    private <span class="type">static</span> <span class="type">int</span>[] closest = new <span class="type">int</span>[MAXN];</span><br><span class="line">    private <span class="type">static</span> <span class="type">int</span>[] lowcost = new <span class="type">int</span>[MAXN];</span><br><span class="line">    private <span class="type">static</span> <span class="type">int</span>[][] G = new <span class="type">int</span>[MAXN][MAXN];</span><br><span class="line">    private <span class="type">static</span> <span class="type">int</span> m;</span><br><span class="line">    private <span class="type">static</span> List demo = new ArrayList();</span><br><span class="line"></span><br><span class="line">    public <span class="type">static</span> <span class="type">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Scanner scanner = new Scanner(System.in);</span><br><span class="line">        m = scanner.nextInt();</span><br><span class="line">        <span class="type">int</span> n = scanner.nextInt();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> a = scanner.nextInt();</span><br><span class="line">            <span class="type">int</span> b = scanner.nextInt();</span><br><span class="line">            <span class="type">int</span> c = scanner.nextInt();</span><br><span class="line">            G[b][a] = G[a][b] = c;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(prim());</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            System.out.print(demo.get(i) + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="type">static</span> <span class="type">int</span> <span class="title function_">prim</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            lowcost[i] = INF;</span><br><span class="line">            closest[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        closest[<span class="number">0</span>] = <span class="number">-1</span>;<span class="comment">//加入第一个点，-1表示该点在集合U中，否则在集合V中</span></span><br><span class="line">        <span class="type">int</span> num = <span class="number">0</span>, ans = <span class="number">0</span>, e = <span class="number">0</span>;<span class="comment">//e为最新加入集合的点</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (num &lt; m - <span class="number">1</span>)<span class="comment">//加入m-1条边</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> micost = INF, miedge = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (closest[i] != <span class="number">-1</span>) &#123;</span><br><span class="line">                    <span class="type">int</span> temp = G[e][i];</span><br><span class="line">                    <span class="keyword">if</span> (temp &lt; lowcost[i]) &#123;</span><br><span class="line">                        lowcost[i] = temp;</span><br><span class="line">                        closest[i] = e;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (lowcost[i] &lt; micost) &#123;</span><br><span class="line">                        micost = lowcost[miedge = i];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += micost;</span><br><span class="line">            demo.add(micost);</span><br><span class="line">            closest[e = miedge] = <span class="number">-1</span>;</span><br><span class="line">            num++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">INF = <span class="number">0x3f3f3f3f</span></span><br><span class="line">MAXN = <span class="number">1005</span></span><br><span class="line">closest = [<span class="number">0</span>] * MAXN</span><br><span class="line">lowcost = [<span class="number">0</span>] * MAXN</span><br><span class="line">G = [[INF] * MAXN <span class="keyword">for</span> _ in range(MAXN)]</span><br><span class="line">demo = []</span><br><span class="line"></span><br><span class="line">m,n = <span class="built_in">map</span>(<span class="type">int</span>, input().split())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in range(n):</span><br><span class="line">    a,b,c = <span class="built_in">map</span>(<span class="type">int</span>, input().split())</span><br><span class="line">    G[b][a]=G[a][b]=c</span><br><span class="line"></span><br><span class="line">def prim():</span><br><span class="line">    global closest, lowcost, G, m</span><br><span class="line">    <span class="keyword">for</span> i in range(m):</span><br><span class="line">        lowcost[i] = INF</span><br><span class="line">        closest[i] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    closest[<span class="number">0</span>] = <span class="number">-1</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    e = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> num &lt; m<span class="number">-1</span>:</span><br><span class="line">        micost = INF</span><br><span class="line">        miedge = <span class="number">-1</span></span><br><span class="line">        <span class="keyword">for</span> i in range(m):</span><br><span class="line">            <span class="keyword">if</span> closest[i] != <span class="number">-1</span>:</span><br><span class="line">                temp = G[e][i]</span><br><span class="line">                <span class="keyword">if</span> temp &lt; lowcost[i]:</span><br><span class="line">                    lowcost[i] = temp</span><br><span class="line">                    closest[i] = e</span><br><span class="line">                <span class="keyword">if</span> lowcost[i] &lt; micost:</span><br><span class="line">                    miedge=i</span><br><span class="line">                    micost = lowcost[miedge]</span><br><span class="line">        ans += micost</span><br><span class="line">        demo.append(micost)</span><br><span class="line">        e = miedge</span><br><span class="line">        closest[e] = <span class="number">-1</span></span><br><span class="line">        num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">print(prim())</span><br><span class="line"><span class="keyword">for</span> i in range(m - <span class="number">1</span>): print(demo[i], end=<span class="string">&#x27; &#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="kruskal-算法"><a href="#kruskal-算法" class="headerlink" title="kruskal 算法"></a>kruskal 算法</h3><p>对边进行贪心操作：“最短的边一定在 <code>MST</code> 上”。 从最短的边开始，把它加入到 <code>MST</code> 中；在剩下的边中找最短的边，加入到 <code>MST</code> 中；继续这个过程，直到所有点都在 <code>MST</code> 中。</p>
<p><code>kruskal</code> 算法的 2 个关键技术： （1）对边进行排序。 （2）判断圈，即处理连通性问题。这个问题用并查集简单而高效，并查集是 <code>kruskal</code> 算法的实现基础。</p>
<p>初始时最小生成树 <code>MST</code> 为空。开始的时候，每个点属于独立的集。</p>
<p>按边长从小到大进行边的遍历操作：</p>
<p>尝试将最小边加入最小生成树：</p>
<ul>
<li>如果边的两个端点属于同一个集合，就说明这两个点已经被加入最小生成树。则不能将边加入，否则就会生成一个环。</li>
<li>如果两个端点不属于同一个集合，就说明该点还未纳入最小生成树，此边可以加入。</li>
</ul>
<p>重复上述操作，直到加入 <code>n-1</code> 条边。</p>
<p><code>kruskal</code> 算法的复杂度包括两部分：对边的排序 <code>O(ElogE)</code>，并查集的操作 <code>O(E)</code>，一共是 <code>O(ElogE + E)</code>，约等于 <code>O(ElogE)</code>，时间主要花在排序上。</p>
<p>如果图的边很多，<code>kruskal</code> 的复杂度要差一些。<code>kruskal</code> 适用于稀疏图，<code>prim</code> 适合稠密图。</p>
<p><strong>模板如下：</strong></p>
<figure class="hljs highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> father[<span class="number">1100000</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="type">int</span> y;</span><br><span class="line">    <span class="type">int</span> k;</span><br><span class="line">&#125; Q[<span class="number">1100000</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">find</span><span class="params">(<span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (father[x] == x)</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">return</span> father[x] = find(father[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> <span class="title function_">cmp</span><span class="params">(node a, node b)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a.k &lt; b.k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> cont = <span class="number">0</span>,</span><br><span class="line">        sum = <span class="number">0</span>, st = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;Q[i].x, &amp;Q[i].y, &amp;Q[i].k);</span><br><span class="line">        cont += Q[i].k;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(Q, Q + m, cmp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        father[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> tx = find(Q[i].x);</span><br><span class="line">        <span class="type">int</span> ty = find(Q[i].y);</span><br><span class="line">        <span class="keyword">if</span> (tx != ty)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += Q[i].k;</span><br><span class="line">            st++;</span><br><span class="line">            father[tx] = ty;</span><br><span class="line">            <span class="keyword">if</span> (st == n - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">import java.util.Arrays;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Main</span> &#123;</span></span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> n, m;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span>[] father;</span><br><span class="line">    <span class="type">static</span> Node[] Q;</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="type">int</span> y;</span><br><span class="line">        <span class="type">int</span> k;</span><br><span class="line"></span><br><span class="line">        public <span class="title function_">Node</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">            this.x = x;</span><br><span class="line">            this.y = y;</span><br><span class="line">            this.k = k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public <span class="type">static</span> <span class="type">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Scanner scanner = new Scanner(System.in);</span><br><span class="line">        n = scanner.nextInt();</span><br><span class="line">        m = scanner.nextInt();</span><br><span class="line"></span><br><span class="line">        father = new <span class="type">int</span>[n + <span class="number">1</span>];</span><br><span class="line">        Q = new Node[m];</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> cont = <span class="number">0</span>, sum = <span class="number">0</span>, st = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="type">int</span> x = scanner.nextInt();</span><br><span class="line">            <span class="type">int</span> y = scanner.nextInt();</span><br><span class="line">            <span class="type">int</span> k = scanner.nextInt();</span><br><span class="line">            Q[i] = new Node(x, y, k);</span><br><span class="line">            cont += k;</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(Q, (a, b) -&gt; a.k - b.k);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            father[i] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="type">int</span> tx = find(Q[i].x);</span><br><span class="line">            <span class="type">int</span> ty = find(Q[i].y);</span><br><span class="line">            <span class="keyword">if</span> (tx != ty) &#123;</span><br><span class="line">                sum += Q[i].k;</span><br><span class="line">                st++;</span><br><span class="line">                father[tx] = ty;</span><br><span class="line">                <span class="keyword">if</span> (st == n - <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> <span class="title function_">find</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (father[x] == x)</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        <span class="keyword">return</span> father[x] = find(father[x]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">n, m = <span class="built_in">map</span>(<span class="type">int</span>, input().split())</span><br><span class="line"></span><br><span class="line">father = [i <span class="keyword">for</span> i in range(n+<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">Q = []</span><br><span class="line"></span><br><span class="line">cont = <span class="number">0</span></span><br><span class="line">sum = <span class="number">0</span></span><br><span class="line">st = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in range(m):</span><br><span class="line">    x, y, k = <span class="built_in">map</span>(<span class="type">int</span>, input().split())</span><br><span class="line">    Q.append(&#123;<span class="string">&#x27;x&#x27;</span>: x, <span class="string">&#x27;y&#x27;</span>: y, <span class="string">&#x27;k&#x27;</span>: k&#125;)</span><br><span class="line">    cont += k</span><br><span class="line"></span><br><span class="line">Q.sort(key=lambda x:x[<span class="string">&#x27;k&#x27;</span>])</span><br><span class="line"></span><br><span class="line">def find(x):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> father[x] == x :</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">    father[x] = find(father[x])</span><br><span class="line">    <span class="keyword">return</span> father[x]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in range(m):</span><br><span class="line">    tx = find(Q[i][<span class="string">&#x27;x&#x27;</span>])</span><br><span class="line">    ty = find(Q[i][<span class="string">&#x27;y&#x27;</span>])</span><br><span class="line">    <span class="keyword">if</span> tx != ty:</span><br><span class="line">        sum += Q[i][<span class="string">&#x27;k&#x27;</span>]</span><br><span class="line">        st += <span class="number">1</span></span><br><span class="line">        father[tx] = ty</span><br><span class="line">        <span class="keyword">if</span> st == n - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(sum)</span><br></pre></td></tr></table></figure>

<hr>
<p>show: step version: 1.0 enable_checker: true</p>
<hr>
<h1 id="图论例题"><a href="#图论例题" class="headerlink" title="图论例题"></a>图论例题</h1><h2 id="蓝桥王国-lanqiaoOJ-题号-1122"><a href="#蓝桥王国-lanqiaoOJ-题号-1122" class="headerlink" title="蓝桥王国 lanqiaoOJ 题号 1122"></a>蓝桥王国 lanqiaoOJ 题号 1122</h2><p><strong>题目描述</strong></p>
<p>蓝桥王国一共有 (N) 个建筑和 (M) 条单向道路，每条道路都连接着两个建筑，每个建筑都有自己编号，分别为 (1 \sim N)。（其中皇宫的编号为 1）国王想让小明回答从皇宫到每个建筑的最短路径是多少，但紧张的小明此时已经无法思考，请你编写程序帮助小明回答国王的考核。</p>
<p><strong>输入描述</strong></p>
<p>输入第一行包含 2 个正整数 (N,M)。第 2 到 (M+1) 行每行包含三个正整数 (u,v,w)，表示 (u \to v) 之间存在一条距离为 (w) 的路。(1 \leq N \leq 3 \times 10^5)，(1 \leq M \leq 10^6)，(1 \leq u_i , v_i \leq N)，(0 \leq w_i \leq 10^9)。</p>
<p><strong>输出描述</strong></p>
<p>输出仅一行，共 (N) 个数，分别表示从皇宫到编号为 (1 \sim N) 建筑的最短距离，两两之间用空格隔开。（如果无法到达则输出 −1）</p>
<p><strong>解题思路:</strong></p>
<p>本题为单源最短路的模板题，直接套模板即可，本题我们采用 Dijkstra。</p>
<p>C++ 语言描述:</p>
<figure class="hljs highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">long</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>LL;</span><br><span class="line"><span class="comment">//这样定义INF的好处是: INF &lt;= INF+x</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N= <span class="number">3e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> from, to; <span class="type">long</span> <span class="type">long</span> w; <span class="comment">//起点，终点，权值。起点from并没有用到，e[i]的i就是from</span></span><br><span class="line">    <span class="built_in">edge</span>(<span class="type">int</span> a, <span class="type">int</span> b,<span class="type">long</span> <span class="type">long</span> c)&#123;from=a; to=b; w=c;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;edge&gt;e[N];          <span class="comment">//用于存储图</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">s_node</span>&#123;</span><br><span class="line">    <span class="type">int</span> id; <span class="type">long</span> <span class="type">long</span> n_dis;   <span class="comment">//id：结点；n_dis：这个结点到起点的距离</span></span><br><span class="line">    <span class="built_in">s_node</span>(<span class="type">int</span> b,<span class="type">long</span> <span class="type">long</span> c)&#123;id=b; n_dis=c;&#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> s_node &amp; a) <span class="type">const</span></span><br><span class="line">    &#123; <span class="keyword">return</span> n_dis &gt; a.n_dis;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="type">int</span> pre[N];                                <span class="comment">//记录前驱结点，用于生成路径</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print_path</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> </span>&#123;            <span class="comment">//打印从s到t的最短路</span></span><br><span class="line">    <span class="keyword">if</span>(s==t)&#123; <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, s); <span class="keyword">return</span>; &#125;  <span class="comment">//打印起点</span></span><br><span class="line">    <span class="built_in">print_path</span>(s, pre[t]);                 <span class="comment">//先打印前一个点</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, t);                      <span class="comment">//后打印当前点。最后打印的是终点t</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span>  dis[N];         <span class="comment">//记录所有结点到起点的距离</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dijkstra</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">1</span>;             <span class="comment">//起点s是1</span></span><br><span class="line">    <span class="type">bool</span> done[N]; <span class="comment">//done[i]=true表示到结点i的最短路径已经找到</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;dis[i]=INF; done[i]=<span class="literal">false</span>; &#125;    <span class="comment">//初始化</span></span><br><span class="line">    dis[s]=<span class="number">0</span>;                           <span class="comment">//起点到自己的距离是0</span></span><br><span class="line">    priority_queue &lt;s_node&gt; Q;          <span class="comment">//优先队列，存结点信息</span></span><br><span class="line">    Q.<span class="built_in">push</span>(<span class="built_in">s_node</span>(s, dis[s]));          <span class="comment">//起点进队列</span></span><br><span class="line">    <span class="keyword">while</span> (!Q.<span class="built_in">empty</span>())   &#123;</span><br><span class="line">        s_node u = Q.<span class="built_in">top</span>();             <span class="comment">//pop出距起点s距离最小的结点u</span></span><br><span class="line">        Q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span>(done[u.id])  <span class="keyword">continue</span>;       <span class="comment">//丢弃已经找到最短路径的结点。即集合A中的结点</span></span><br><span class="line">        done[u.id]= <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;e[u.id].<span class="built_in">size</span>(); i++) &#123;  <span class="comment">//检查结点u的所有邻居</span></span><br><span class="line">            edge y = e[u.id][i];         <span class="comment">//u.id的第i个邻居是y.to</span></span><br><span class="line">            <span class="keyword">if</span>(done[y.to])  <span class="keyword">continue</span>;    <span class="comment">//丢弃已经找到最短路径的邻居结点</span></span><br><span class="line">            <span class="keyword">if</span> (dis[y.to] &gt; y.w + u.n_dis) &#123;</span><br><span class="line">                dis[y.to] = y.w + u.n_dis;</span><br><span class="line">                Q.<span class="built_in">push</span>(<span class="built_in">s_node</span>(y.to, dis[y.to]));  <span class="comment">//扩展新的邻居，放到优先队列中</span></span><br><span class="line">                pre[y.to]=u.id;  <span class="comment">//如果有需要，记录路径</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// print_path(s,n);          //如果有需要，打印路径: 起点1，终点n</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)    e[i].<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="type">int</span> u,v,w;  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%lld&quot;</span>,&amp;u,&amp;v,&amp;w);</span><br><span class="line">        e[u].<span class="built_in">push_back</span>(<span class="built_in">edge</span>(u,v,w));</span><br><span class="line">     <span class="comment">// e[v].push_back(edge(v,u,w));    //本题是单向道路</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dijkstra</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(dis[i]&gt;=INF)  cout&lt;&lt;<span class="string">&quot;-1 &quot;</span>;</span><br><span class="line">        <span class="keyword">else</span>   <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, dis[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="hljs highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line">INF = <span class="number">0x3f3f3f3f3f3f3f3f</span></span><br><span class="line">N = <span class="number">300002</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Edge</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, fr, to, w</span>):</span><br><span class="line">        self.fr = fr</span><br><span class="line">        self.to = to</span><br><span class="line">        self.w = w</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SNode</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, <span class="built_in">id</span>, n_dis</span>):</span><br><span class="line">        self.<span class="built_in">id</span> = <span class="built_in">id</span></span><br><span class="line">        self.n_dis = n_dis</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__lt__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> self.n_dis &lt; other.n_dis</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print_path</span>(<span class="params">s, t</span>):</span><br><span class="line">    <span class="keyword">if</span> s == t:</span><br><span class="line">        <span class="built_in">print</span>(s, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    print_path(s, pre[t])</span><br><span class="line">    <span class="built_in">print</span>(t, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>():</span><br><span class="line">    s = <span class="number">1</span></span><br><span class="line">    done = [<span class="literal">False</span>] * N</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"> dis = [INF] * N</span><br><span class="line">    pre = [-<span class="number">1</span>] * N</span><br><span class="line">    dis[s] = <span class="number">0</span></span><br><span class="line">    pq = []</span><br><span class="line">    heapq.heappush(pq, SNode(s, dis[s]))</span><br><span class="line">    <span class="keyword">while</span> pq:</span><br><span class="line">        u = heapq.heappop(pq)</span><br><span class="line">        <span class="keyword">if</span> done[u.<span class="built_in">id</span>]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        done[u.<span class="built_in">id</span>] = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> e[u.<span class="built_in">id</span>]:</span><br><span class="line">            <span class="keyword">if</span> done[y.to]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> dis[y.to] &gt; y.w + u.n_dis:</span><br><span class="line">                dis[y.to] = y.w + u.n_dis</span><br><span class="line">                heapq.heappush(pq, SNode(y.to, dis[y.to]))</span><br><span class="line">                pre[y.to] = u.<span class="built_in">id</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> dis[i] &gt;= INF:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-1&quot;</span>, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(dis[i], end=<span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line">n, m = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line">e = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    u, v, w = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line">    e[u].append(Edge(u, v, w))</span><br><span class="line"></span><br><span class="line">dijkstra()</span><br></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="hljs highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">INF</span> <span class="operator">=</span> <span class="number">0x3f3f3f3f3f3f3f3fL</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">300005</span>;</span><br><span class="line">    <span class="keyword">static</span> ArrayList&lt;Edge&gt;[] e = <span class="keyword">new</span> <span class="title class_">ArrayList</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> n, m;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] pre = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] dis = <span class="keyword">new</span> <span class="title class_">long</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">boolean</span>[] done = <span class="keyword">new</span> <span class="title class_">boolean</span>[N];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> from, to;</span><br><span class="line">        <span class="type">long</span> w;</span><br><span class="line"></span><br><span class="line">        Edge(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">long</span> c) &#123;</span><br><span class="line">            from = a;</span><br><span class="line">            to = b;</span><br><span class="line">            w = c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SNode</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;SNode&gt; &#123;</span><br><span class="line">        <span class="type">int</span> id;</span><br><span class="line">        <span class="type">long</span> n_dis;</span><br><span class="line"></span><br><span class="line">        SNode(<span class="type">int</span> b, <span class="type">long</span> c) &#123;</span><br><span class="line">            id = b;</span><br><span class="line">            n_dis = c;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(SNode o)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Long.compare(n_dis, o.n_dis);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printPath</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (s == t) &#123;</span><br><span class="line">            System.out.print(s + <span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        printPath(s, pre[t]);</span><br><span class="line">        System.out.print(t + <span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">dijkstra</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">s</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        PriorityQueue&lt;SNode&gt; Q = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;();</span><br><span class="line">        Arrays.fill(dis, INF);</span><br><span class="line">        dis[s] = <span class="number">0</span>;</span><br><span class="line">        Q.offer(<span class="keyword">new</span> <span class="title class_">SNode</span>(s, dis[s]));</span><br><span class="line">        <span class="keyword">while</span> (!Q.isEmpty()) &#123;</span><br><span class="line">            <span class="type">SNode</span> <span class="variable">u</span> <span class="operator">=</span> Q.poll();</span><br><span class="line">            <span class="keyword">if</span> (done[u.id])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            done[u.id] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">for</span> (Edge y : e[u.id]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (done[y.to])</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (dis[y.to] &gt; y.w + u.n_dis) &#123;</span><br><span class="line">                    dis[y.to] = y.w + u.n_dis;</span><br><span class="line">                    Q.offer(<span class="keyword">new</span> <span class="title class_">SNode</span>(y.to, dis[y.to]));</span><br><span class="line">                    pre[y.to] = u.id;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// printPath(s, n);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line">        <span class="type">StringTokenizer</span> <span class="variable">st</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringTokenizer</span>(br.readLine());</span><br><span class="line">        n = Integer.parseInt(st.nextToken());</span><br><span class="line">        m = Integer.parseInt(st.nextToken());</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            e[i] = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            st = <span class="keyword">new</span> <span class="title class_">StringTokenizer</span>(br.readLine());</span><br><span class="line">            <span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> Integer.parseInt(st.nextToken());</span><br><span class="line">            <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> Integer.parseInt(st.nextToken());</span><br><span class="line">            <span class="type">long</span> <span class="variable">w</span> <span class="operator">=</span> Long.parseLong(st.nextToken());</span><br><span class="line">            e[u].add(<span class="keyword">new</span> <span class="title class_">Edge</span>(u, v, w));</span><br><span class="line">            <span class="comment">// e[v].add(new Edge(v, u, w)); //本题是单向道路</span></span><br><span class="line">        &#125;</span><br><span class="line">        dijkstra();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dis[i] &gt;= INF)</span><br><span class="line">                System.out.print(<span class="string">&quot;-1 &quot;</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                System.out.print(dis[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="随机数据下的最短路问题-lanqiaoOJ-题号-1366"><a href="#随机数据下的最短路问题-lanqiaoOJ-题号-1366" class="headerlink" title="随机数据下的最短路问题 lanqiaoOJ 题号 1366"></a>随机数据下的最短路问题 lanqiaoOJ 题号 1366</h2><p><strong>题目描述</strong></p>
<p>给定 (N) 个点和 (M) 条单向道路，每条道路都连接着两个点，每个点都有自己编号，分别为 (1 \sim N)。问你从 (S) 点出发，到达每个点的最短路径为多少。</p>
<p><strong>输入描述</strong></p>
<p>输入第一行包含三个正整数 (N,M,S)。第 2 到 (M+1) 行每行包含三个正整数 (u,v,w)，表示 (u \to v) 之间存在一条距离为 (w) 的路。(1 \leq N \leq 5 \times 10^3)，(1 \leq M \leq 5 \times 10^4)，(1 \leq u_i, v_i \leq N)，(0 \leq w_i \leq 10^9)。</p>
<p><strong>输出描述</strong></p>
<p>输出仅一行，共 (N) 个数，分别表示从编号 (S) 到编号为 (1 \sim N) 点的最短距离，两两之间用空格隔开。（如果无法到达则输出 −1）</p>
<p><strong>解题思路:</strong></p>
<p>本题为单源最短路的模板题，直接套模板即可，本题我们采用 SPFA。</p>
<p>C++ 语言描述:</p>
<figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">long</span> INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e3</span>+<span class="number">10</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> to;    <span class="type">long</span> <span class="type">long</span> w;</span><br><span class="line">    <span class="built_in">edge</span>(<span class="type">int</span> tt,<span class="type">long</span> <span class="type">long</span> ww) &#123;to = tt; w = ww;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> dist[N];</span><br><span class="line"><span class="type">int</span> inq[N];</span><br><span class="line">vector&lt;edge&gt; e[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> s)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dist,<span class="number">0x3f</span>,<span class="built_in">sizeof</span>(dist));</span><br><span class="line">    dist[s] = <span class="number">0</span>;      <span class="comment">//起点到自己的距离是0</span></span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s);        <span class="comment">//从s开始，s进队列</span></span><br><span class="line">    inq[s] = <span class="number">1</span>;       <span class="comment">//起点在队列中</span></span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        inq[u] = <span class="number">0</span>;   <span class="comment">//u已经不在队列中</span></span><br><span class="line">        <span class="keyword">if</span>(dist[u] == INF)     <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; e[u].<span class="built_in">size</span>();i++) &#123;   <span class="comment">//遍历u的邻居</span></span><br><span class="line">            <span class="type">int</span> v = e[u][i].to;</span><br><span class="line">            <span class="type">long</span> <span class="type">long</span> w = e[u][i].w;</span><br><span class="line">            <span class="keyword">if</span>(dist[v] &gt; dist[u]+w) &#123;         <span class="comment">//u的第i个邻居v，它借道u，到s更近</span></span><br><span class="line">                dist[v] = dist[u]+w;          <span class="comment">//更新邻居v到s的距离</span></span><br><span class="line">                <span class="keyword">if</span>(!inq[v]) &#123;      <span class="comment">//邻居v更新状态了，但v不在队列中，放进队列</span></span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                    inq[v] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m,s;cin&gt;&gt;n&gt;&gt;m&gt;&gt;s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= m;i++)    &#123;</span><br><span class="line">        <span class="type">int</span> u,v; <span class="type">long</span> <span class="type">long</span> w;</span><br><span class="line">        cin&gt;&gt;u&gt;&gt;v&gt;&gt;w;</span><br><span class="line">        e[u].<span class="built_in">push_back</span>(<span class="built_in">edge</span>(v,w));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">spfa</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n;i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(dist[i]==INF)  cout &lt;&lt; <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">else</span>              cout &lt;&lt; dist[i];</span><br><span class="line">        <span class="keyword">if</span>(i != n)        cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="keyword">else</span>              cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="hljs highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line">INF = <span class="number">0x3f3f3f3f3f3f3f3f</span></span><br><span class="line">N = <span class="number">5010</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Edge</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, to, w</span>):</span><br><span class="line">        self.to = to</span><br><span class="line">        self.w = w</span><br><span class="line"></span><br><span class="line">dist = [INF] * N</span><br><span class="line">inq = [<span class="number">0</span>] * N</span><br><span class="line">e = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">spfa</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">global</span> dist</span><br><span class="line">    <span class="keyword">global</span> inq</span><br><span class="line">    dist = [INF] * N</span><br><span class="line">    dist[s] = <span class="number">0</span></span><br><span class="line">    q = []</span><br><span class="line">    heapq.heappush(q, s)</span><br><span class="line">    inq[s] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> q:</span><br><span class="line">        u = heapq.heappop(q)</span><br><span class="line">        inq[u] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> dist[u] == INF:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e[u])):</span><br><span class="line">            v = e[u][i].to</span><br><span class="line">            w = e[u][i].w</span><br><span class="line">            <span class="keyword">if</span> dist[v] &gt; dist[u] + w:</span><br><span class="line">                dist[v] = dist[u] + w</span><br><span class="line">                <span class="keyword">if</span> inq[v] == <span class="number">0</span>:</span><br><span class="line">                    heapq.heappush(q, v)</span><br><span class="line">                    inq[v] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">n, m, s = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    u, v, w = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line">    e[u].append(Edge(v, w))</span><br><span class="line">spfa(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> dist[i] == INF:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;-1&quot;</span>, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(dist[i], end=<span class="string">&quot; &quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="hljs highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">INF</span> <span class="operator">=</span> <span class="number">0x3f3f3f3f3f3f3f3fL</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">5010</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[] dist = <span class="keyword">new</span> <span class="title class_">long</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] inq = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">    <span class="keyword">static</span> List&lt;edge&gt;[] e = <span class="keyword">new</span> <span class="title class_">ArrayList</span>[N];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">edge</span> &#123;</span><br><span class="line">        <span class="type">int</span> to;</span><br><span class="line">        <span class="type">long</span> w;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">edge</span><span class="params">(<span class="type">int</span> tt, <span class="type">long</span> ww)</span> &#123;</span><br><span class="line">            to = tt;</span><br><span class="line">            w = ww;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">spfa</span><span class="params">(<span class="type">int</span> s)</span> &#123;</span><br><span class="line">        Arrays.fill(dist, INF);</span><br><span class="line">        dist[s] = <span class="number">0</span>;</span><br><span class="line">        Queue&lt;Integer&gt; q = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        q.add(s);</span><br><span class="line">        inq[s] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!q.isEmpty()) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> q.poll();</span><br><span class="line">            inq[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (dist[u] == INF) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; e[u].size(); i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> e[u].get(i).to;</span><br><span class="line">                <span class="type">long</span> <span class="variable">w</span> <span class="operator">=</span> e[u].get(i).w;</span><br><span class="line">                <span class="keyword">if</span> (dist[v] &gt; dist[u] + w) &#123;</span><br><span class="line">                    dist[v] = dist[u] + w;</span><br><span class="line">                    <span class="keyword">if</span> (inq[v] == <span class="number">0</span>) &#123;</span><br><span class="line">                        q.add(v);</span><br><span class="line">                        inq[v] = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">s</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            e[i] = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">            <span class="type">int</span> <span class="variable">v</span> <span class="operator">=</span> in.nextInt();</span><br><span class="line">            <span class="type">long</span> <span class="variable">w</span> <span class="operator">=</span> in.nextLong();</span><br><span class="line">            e[u].add(<span class="keyword">new</span> <span class="title class_">edge</span>(v, w));</span><br><span class="line">        &#125;</span><br><span class="line">        spfa(s);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dist[i] == INF) System.out.print(<span class="string">&quot;-1 &quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> System.out.print(dist[i] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="路径-OJ-编号-1460"><a href="#路径-OJ-编号-1460" class="headerlink" title="路径 OJ 编号 1460"></a>路径 OJ 编号 1460</h2><p><img src="/./../imgs/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/e77a71de068da604d1245d5231201326-0.png" alt="图片描述"></p>
<p><strong>解题思路:</strong></p>
<p>填空题对时间没有要求，用最简单的 floyd</p>
<p>C++ 语言描述:</p>
<figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3000</span>;</span><br><span class="line"><span class="type">const</span> ll INF = <span class="number">1e18</span>;</span><br><span class="line">ll mp[N][N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">floyd</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>;k &lt;= n;k++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n;i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>;j &lt;= n;j++)</span><br><span class="line">                mp[i][j] = <span class="built_in">min</span>(mp[i][j], mp[i][k] + mp[k][j]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">2021</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>;j &lt;= n;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i == j) mp[i][j] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">abs</span>(i - j)&lt;=<span class="number">21</span>) mp[i][j]=mp[j][i]=i*j/__gcd(i, j);</span><br><span class="line">            <span class="keyword">else</span> mp[i][j] = mp[j][i] = INF;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">floyd</span>(n);</span><br><span class="line">    cout &lt;&lt; mp[<span class="number">1</span>][<span class="number">2021</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="hljs highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcm</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(a * b / math.gcd(a, b))</span><br><span class="line"></span><br><span class="line">n = <span class="number">2021</span></span><br><span class="line">g = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">2</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">2</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> i == j:</span><br><span class="line">            g[i][j] = g[j][i] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">abs</span>(i - j) &lt;= <span class="number">21</span>:</span><br><span class="line">            g[i][j] = g[j][i] = lcm(i, j)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            g[i][j] = <span class="number">1000000000</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> g[i][j] &gt; g[i][k] + g[k][j]:</span><br><span class="line">                g[i][j] = g[i][k] + g[k][j]</span><br><span class="line"><span class="built_in">print</span>(g[<span class="number">1</span>][n])</span><br></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="hljs highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">2021</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">gcd</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> b == <span class="number">0</span> ? a : gcd(b, a % b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">lcm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a * b / gcd(a, b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[][] floyd = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; n &amp;&amp; j &lt; i + <span class="number">22</span>; j++)</span><br><span class="line">                floyd[i][j] = floyd[j][i] = lcm(i + <span class="number">1</span>, j + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; n; k++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">                    <span class="keyword">if</span> (floyd[i][k] != <span class="number">0</span> &amp;&amp; floyd[k][j] != <span class="number">0</span> &amp;&amp; (floyd[i][j] == <span class="number">0</span> || floyd[i][k] + floyd[k][j] &lt; floyd[i][j]))</span><br><span class="line">                        floyd[i][j] = floyd[i][k] + floyd[k][j];</span><br><span class="line">        System.out.println(floyd[<span class="number">0</span>][n - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="出差"><a href="#出差" class="headerlink" title="出差"></a>出差</h2><p><img src="/./../imgs/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/6fab239959de9ee1ffb4d57d7654fabf-0.png" alt="图片描述"></p>
<p><strong>解题思路:</strong></p>
<p><img src="/./../imgs/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/a28b434cf3a3579931db1586e3d0d710-0.png" alt="图片描述"></p>
<p>我们这里给大家一个朴素的 dijkstra 的模板，大家感受一下，优先队列到底优化的那一部分。</p>
<p>C++ 语言描述:</p>
<figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1010</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//邻接矩阵</span></span><br><span class="line"><span class="type">int</span> gra[N][N];</span><br><span class="line"><span class="type">int</span> dist[N];</span><br><span class="line"><span class="type">int</span> g[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="comment">//朴素版dijkstra</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dijkstra</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     <span class="built_in">memset</span>(dist, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> dist);</span><br><span class="line">    dist[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i ++ )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> t = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j ++ )</span><br><span class="line">            <span class="keyword">if</span> (!st[j] &amp;&amp; (t == <span class="number">-1</span> || dist[t] &gt; dist[j]))</span><br><span class="line">                t = j;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j ++ )</span><br><span class="line">            dist[j] = <span class="built_in">min</span>(dist[j], dist[t] + gra[t][j]);</span><br><span class="line">        st[t] = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dist[n];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) cin&gt;&gt;g[i];</span><br><span class="line">    g[n]=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(gra, <span class="number">0x3f</span>, <span class="keyword">sizeof</span> gra);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i)&#123;</span><br><span class="line">        <span class="type">int</span> u,v,c;</span><br><span class="line">        cin&gt;&gt;u&gt;&gt;v&gt;&gt;c;</span><br><span class="line">        gra[u][v]=g[v]+c;</span><br><span class="line">        gra[v][u]=g[u]+c;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;<span class="built_in">dijkstra</span>()&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="hljs highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span></span><br><span class="line"></span><br><span class="line">n, m = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 邻接矩阵</span></span><br><span class="line">gra = [[<span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)] * (n+<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n+<span class="number">1</span>)]</span><br><span class="line">dist = [<span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>)] * (n+<span class="number">1</span>)</span><br><span class="line">g = [<span class="number">0</span>] + <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split()))</span><br><span class="line">g[n] = <span class="number">0</span></span><br><span class="line">st = [<span class="literal">False</span>] * (n+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 朴素版 Dijkstra</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>() -&gt; <span class="built_in">int</span>:</span><br><span class="line">    dist[<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">        t = -<span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> st[j] <span class="keyword">and</span> (t == -<span class="number">1</span> <span class="keyword">or</span> dist[t] &gt; dist[j]):</span><br><span class="line">                t = j</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">            dist[j] = <span class="built_in">min</span>(dist[j], dist[t] + gra[t][j])</span><br><span class="line">        st[t] = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> dist[n]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    u, v, c = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line">    gra[u][v] = g[v] + c</span><br><span class="line">    gra[v][u] = g[u] + c</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dijkstra())</span><br></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="hljs highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">1010</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[][] gra = <span class="keyword">new</span> <span class="title class_">int</span>[N][N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] dist = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] g = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">boolean</span>[] st = <span class="keyword">new</span> <span class="title class_">boolean</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> n, m;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scan</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        n = scan.nextInt();</span><br><span class="line">        m = scan.nextInt();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            g[i] = scan.nextInt();</span><br><span class="line">        &#125;</span><br><span class="line">        g[n] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span> ; i &lt; N ; i ++) Arrays.fill(gra[i], <span class="number">0x3f3f3f</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">u</span> <span class="operator">=</span> scan.nextInt(), v = scan.nextInt(), c = scan.nextInt();</span><br><span class="line">            gra[u][v] = g[v] + c;</span><br><span class="line">            gra[v][u] = g[u] + c;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(dijkstra());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">dijkstra</span><span class="params">()</span> &#123;</span><br><span class="line">        Arrays.fill(dist, <span class="number">10000000</span>);</span><br><span class="line">        dist[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!st[j] &amp;&amp; (t == -<span class="number">1</span> || dist[t] &gt; dist[j])) &#123;</span><br><span class="line">                    t = j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(t == -<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">                dist[j] = Math.min(dist[j], dist[t] + gra[t][j]);</span><br><span class="line">            &#125;</span><br><span class="line">            st[t] = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dist[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="聪明的猴子"><a href="#聪明的猴子" class="headerlink" title="聪明的猴子"></a>聪明的猴子</h2><p><img src="/./../imgs/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/ceeb52dc7e8b316134f2c9c7b74b1c11-0.png" alt="图片描述"></p>
<hr>
<p><strong>解题思路:</strong></p>
<p><img src="/./../imgs/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/f77dcab941517e1b3648b7cb3c2fa740-0.png" alt="图片描述"></p>
<p>C++ 语言描述:</p>
<figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> a[<span class="number">5005</span>], x[<span class="number">5005</span>], y[<span class="number">5005</span>], f[<span class="number">5005</span>];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="type">int</span> y;</span><br><span class="line">    <span class="type">double</span> w;</span><br><span class="line">&#125;edge[<span class="number">1000005</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == f[x])</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    f[x] = <span class="built_in">find</span>(f[x]);</span><br><span class="line">    <span class="keyword">return</span> f[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cmp</span><span class="params">(Edge a, Edge b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.w &lt; b.w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> xx = <span class="built_in">find</span>(x);</span><br><span class="line">    <span class="type">int</span> yy = <span class="built_in">find</span>(y);</span><br><span class="line">    <span class="keyword">if</span> (xx != yy)</span><br><span class="line">        f[yy] = xx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        cin &gt;&gt; a[i];</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        cin &gt;&gt; x[i] &gt;&gt; y[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        f[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">            <span class="type">double</span> w = <span class="built_in">sqrt</span>((x[i] - x[j])*(x[i] - x[j]) + (y[i] - y[j])*(y[i] - y[j]));</span><br><span class="line">            edge[++cnt] = &#123;i, j, w&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(edge + <span class="number">1</span>, edge + cnt + <span class="number">1</span>, cmp);</span><br><span class="line">    <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> max = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">find</span>(edge[i].x)!=<span class="built_in">find</span>(edge[i].y))&#123;</span><br><span class="line">            <span class="built_in">merge</span>(edge[i].x, edge[i].y);</span><br><span class="line">            num++;</span><br><span class="line">            max = max&gt;=edge[i].w?max:edge[i].w;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (num == n - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="keyword">if</span> (a[i] &gt;= max)</span><br><span class="line">            ans++;</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="hljs highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Edge</span>:</span><br><span class="line">    x = <span class="number">0</span></span><br><span class="line">    y = <span class="number">0</span></span><br><span class="line">    w = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, x, y, w</span>):</span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line">        self.w = w</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> f[x]==x:</span><br><span class="line">        <span class="keyword">return</span> f[x]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        f[x] = find(f[x])</span><br><span class="line">        <span class="keyword">return</span> f[x]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">x,y</span>):</span><br><span class="line">    xx = find(x)</span><br><span class="line">    yy = find(y)</span><br><span class="line">    <span class="keyword">if</span> xx!=yy:</span><br><span class="line">        f[yy] = xx</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    m = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">    a = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split()))</span><br><span class="line">    n = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">    x = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">2</span>)]</span><br><span class="line">    y = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">2</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        b = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split()))</span><br><span class="line">        x[i + <span class="number">1</span>] = b[<span class="number">0</span>]</span><br><span class="line">        y[i + <span class="number">1</span>] = b[<span class="number">1</span>]</span><br><span class="line">    edge_list = []</span><br><span class="line">    maxvalue = <span class="number">0</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">            w = math.sqrt((x[i] - x[j]) * (x[i] - x[j]) + (y[i] - y[j]) * (y[i] - y[j]))</span><br><span class="line">            edge =  Edge(i, j, w)</span><br><span class="line">            edge_list.append(edge)</span><br><span class="line"></span><br><span class="line">    edge_list.sort(key=<span class="keyword">lambda</span> x: x.w)</span><br><span class="line">    f = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n + <span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> edge_list:</span><br><span class="line">        <span class="keyword">if</span> find(i.x)!=find(i.y):</span><br><span class="line">            merge(i.x,i.y)</span><br><span class="line">            maxvalue = <span class="built_in">max</span>(maxvalue,i.w)</span><br><span class="line">            num+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> num==n-<span class="number">1</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> a[i]&gt;=maxvalue:</span><br><span class="line">            ans+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="hljs highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> n;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] a;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> m;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] x;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] y;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">double</span> max;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] f;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line">    <span class="keyword">static</span> <span class="type">PrintWriter</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(System.out));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">        m = Integer.parseInt(in.readLine().trim());</span><br><span class="line">        a = <span class="keyword">new</span> <span class="title class_">int</span>[m];</span><br><span class="line">        String[] s = in.readLine().trim().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">            a[i] = Integer.parseInt(s[i]);</span><br><span class="line">        n = Integer.parseInt(in.readLine().trim());</span><br><span class="line">        x = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        y = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;</span><br><span class="line">            s = in.readLine().trim().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            x[i] = Integer.parseInt(s[<span class="number">0</span>]);</span><br><span class="line">            y[i] = Integer.parseInt(s[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        ArrayList&lt;Edge&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n-<span class="number">1</span>;i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;n;j++) &#123;</span><br><span class="line">                <span class="type">double</span> <span class="variable">l</span> <span class="operator">=</span> Math.sqrt((x[i]-x[j])*(x[i]-x[j])+(y[i]-y[j])*(y[i]-y[j]));</span><br><span class="line">                <span class="type">Edge</span> <span class="variable">edge</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Edge</span>(i, j, l);</span><br><span class="line">                list.add(edge);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Collections.sort(list);</span><br><span class="line">        f = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">            f[i] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;list.size();i++) &#123;</span><br><span class="line">            <span class="type">Edge</span> <span class="variable">e</span> <span class="operator">=</span> list.get(i);</span><br><span class="line">            <span class="keyword">if</span>(find(e.x)!=find(e.y)) &#123;</span><br><span class="line">                merge(e.x,e.y);</span><br><span class="line">                max = Math.max(max, e.w);</span><br><span class="line">                num++;</span><br><span class="line">                <span class="keyword">if</span>(num==n-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">            <span class="keyword">if</span>(a[i]&gt;=max)</span><br><span class="line">                ans++;</span><br><span class="line">        System.out.println(ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">find</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(f[x] == x)</span><br><span class="line">            <span class="keyword">return</span> f[x];</span><br><span class="line">        f[x] = find(f[x]);</span><br><span class="line">        <span class="keyword">return</span> f[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">xx</span> <span class="operator">=</span> find(x);</span><br><span class="line">        <span class="type">int</span> <span class="variable">yy</span> <span class="operator">=</span> find(y);</span><br><span class="line">        <span class="keyword">if</span>(xx!=yy)</span><br><span class="line">            f[yy] = xx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Edge</span> <span class="keyword">implements</span> <span class="title class_">Comparable</span>&lt;Edge&gt;&#123;</span><br><span class="line">    <span class="type">int</span> x;</span><br><span class="line">    <span class="type">int</span> y;</span><br><span class="line">    <span class="type">double</span> w;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Edge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">double</span> w)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="built_in">this</span>.x = x;</span><br><span class="line">        <span class="built_in">this</span>.y = y;</span><br><span class="line">        <span class="built_in">this</span>.w = w;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(Edge o)</span> &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.w&gt;o.w?<span class="number">1</span>:-<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="通电"><a href="#通电" class="headerlink" title="通电"></a>通电</h2><p><img src="/./../imgs/%E5%9B%BE%E8%AE%BA%E5%85%A5%E9%97%A8/e0bde279d708165b220cfdf8848e1467-0.png" alt="图片描述"></p>
<p><strong>解题思路:</strong></p>
<p>给了你 <code>n</code> 个节点，又给了你 <code>n</code> 个基点之间相互连接需要多少钱，现在要 <code>n</code> 个村庄都通电，只需要保证 <code>n</code> 个节点构成连通子图即可。</p>
<p>最小的连通子图是树，也就是构造一棵树，那么在图上构造一棵最最少花费的树的问题即为最小生成树。</p>
<p>C++ 语言描述:</p>
<figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">1005</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; demo;</span><br><span class="line"><span class="type">double</span> closest[MAXN], lowcost[MAXN];</span><br><span class="line"><span class="type">int</span> m, n;             <span class="comment">// m为节点的个数，n为边的数量</span></span><br><span class="line"><span class="type">double</span> G[MAXN][MAXN]; <span class="comment">// 邻接矩阵</span></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">prim</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        lowcost[i] = INF;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        closest[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    closest[<span class="number">0</span>] = <span class="number">-1</span>;             <span class="comment">// 加入第一个点，-1表示该点在集合U中，否则在集合V中</span></span><br><span class="line">    <span class="type">int</span> num = <span class="number">0</span>,  e = <span class="number">0</span>; <span class="comment">// e为最新加入集合的点</span></span><br><span class="line">    <span class="type">double</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (num &lt; m - <span class="number">1</span>)          <span class="comment">// 加入m-1条边</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> miedge = <span class="number">-1</span>;</span><br><span class="line">        <span class="type">double</span> micost = INF;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">            <span class="keyword">if</span> (closest[i] != <span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">double</span> temp = G[e][i];</span><br><span class="line">                <span class="keyword">if</span> (temp &lt; lowcost[i])</span><br><span class="line">                &#123;</span><br><span class="line">                    lowcost[i] = temp;</span><br><span class="line">                    closest[i] = e;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (lowcost[i] &lt; micost)</span><br><span class="line">                    micost = lowcost[miedge = i];</span><br><span class="line">            &#125;</span><br><span class="line">        ans += micost;</span><br><span class="line">        demo.<span class="built_in">push_back</span>(micost);</span><br><span class="line">        closest[e = miedge] = <span class="number">-1</span>;</span><br><span class="line">        num++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">double</span> x, y, h;</span><br><span class="line">&#125; dis[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">getDistance</span><span class="params">(node a, node b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(<span class="built_in">pow</span>(a.x - b.x, <span class="number">2</span>) + <span class="built_in">pow</span>(a.y - b.y, <span class="number">2</span>)) + <span class="built_in">pow</span>(a.h - b.h, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;m);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf%lf&quot;</span>, &amp;dis[i].x, &amp;dis[i].y, &amp;dis[i].h);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m - <span class="number">1</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; m; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            G[i][j] = <span class="built_in">getDistance</span>(dis[i], dis[j]);</span><br><span class="line">            G[j][i] = G[i][j];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2lf&quot;</span>, <span class="built_in">prim</span>());</span><br><span class="line">    <span class="comment">// for (int i = 0; i &lt; m - 1; i++)</span></span><br><span class="line">    <span class="comment">//     cout &lt;&lt; demo[i] &lt;&lt; &quot; &quot;;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="hljs highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caculate</span>(<span class="params">x1,y1,h1,x2,y2,h2</span>):</span><br><span class="line">    <span class="keyword">return</span> math.sqrt( (x1-x2)**<span class="number">2</span>+(y1-y2)**<span class="number">2</span>)+(h1-h2)**<span class="number">2</span>\</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> x!=ufs[x]:</span><br><span class="line">        ufs[x]=find(ufs[x])</span><br><span class="line">    <span class="keyword">return</span> ufs[x]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">kruskal</span>():</span><br><span class="line">    <span class="keyword">global</span> ufs</span><br><span class="line">    ufs=<span class="built_in">list</span>(<span class="built_in">range</span>(n+<span class="number">1</span>))</span><br><span class="line">    my_brige.sort(key=<span class="keyword">lambda</span> x:x[<span class="number">2</span>])</span><br><span class="line">    ans=<span class="number">0</span></span><br><span class="line">    cnt=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> a,b,w <span class="keyword">in</span> my_brige:</span><br><span class="line">        x=find(a)</span><br><span class="line">        y=find(b)</span><br><span class="line">        <span class="keyword">if</span> x==y:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        cnt+=<span class="number">1</span></span><br><span class="line">        ans+=w</span><br><span class="line">        ufs[x]=y</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> cnt==n-<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n=<span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">brige=[[] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n+<span class="number">1</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">    x,y,h=<span class="built_in">map</span>(<span class="built_in">int</span>,<span class="built_in">input</span>().split())</span><br><span class="line">    brige[i]=(x,y,h)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">my_brige=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">        x1,y1,h1=brige[i]</span><br><span class="line">        x2,y2,h2=brige[j]</span><br><span class="line">        w=caculate(x1,y1,h1,x2,y2,h2)</span><br><span class="line">        my_brige.append((i,j,w))</span><br><span class="line">ans=kruskal()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#123;:.2f&#125;&quot;</span>.<span class="built_in">format</span>(ans))</span><br></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="hljs highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> <span class="number">1010</span>;</span><br><span class="line">    <span class="keyword">static</span> List&lt;Node&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] x = <span class="keyword">new</span> <span class="title class_">int</span>[N], y = <span class="keyword">new</span> <span class="title class_">int</span>[N], z = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> n;</span><br><span class="line">    <span class="comment">//并查集数组</span></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] q = <span class="keyword">new</span> <span class="title class_">int</span>[N];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        n = sc.nextInt();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            x[i] = sc.nextInt();</span><br><span class="line">            y[i] = sc.nextInt();</span><br><span class="line">            z[i] = sc.nextInt();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//建边  任意两个村庄都要建边</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> x[i] - x[j];</span><br><span class="line">                <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> y[i] - y[j];</span><br><span class="line">                <span class="type">double</span> <span class="variable">c</span> <span class="operator">=</span> z[i] - z[j];</span><br><span class="line">                <span class="comment">// i 村庄 到  j 村庄的 距离</span></span><br><span class="line">                <span class="type">double</span> <span class="variable">s</span> <span class="operator">=</span> Math.sqrt(l * l + r * r) + c * c;</span><br><span class="line">                list.add(<span class="keyword">new</span> <span class="title class_">Node</span>(i, j, s));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 核心：按权值排序</span></span><br><span class="line">        list.sort(Comparator.comparingDouble(a -&gt; a.w));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            q[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//记录权重之和，答案</span></span><br><span class="line">        <span class="type">double</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> list.get(i).a;</span><br><span class="line">            <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> list.get(i).b;</span><br><span class="line">            <span class="type">double</span> <span class="variable">w</span> <span class="operator">=</span> list.get(i).w;</span><br><span class="line">            a = find(a);</span><br><span class="line">            b = find(b);</span><br><span class="line">            <span class="keyword">if</span> (a != b) &#123;</span><br><span class="line">                q[a] = b;</span><br><span class="line">                res += w;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.printf(<span class="string">&quot;%.2f&quot;</span>, res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">find</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (q[x] != x) q[x] = find(q[x]);</span><br><span class="line">        <span class="keyword">return</span> q[x];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="type">double</span> w;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">double</span> w)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.a = a;</span><br><span class="line">            <span class="built_in">this</span>.b = b;</span><br><span class="line">            <span class="built_in">this</span>.w = w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="机房"><a href="#机房" class="headerlink" title="机房"></a>机房</h2><p>这天, 小明在机房学习。</p>
<p>他发现机房里一共有 �<em>n</em> 台电脑, 编号为 1 到 �<em>n</em>, 电脑和电脑之间有网线连 接, 一共有 �−1<em>n</em>−1 根网线将 �<em>n</em> 台电脑连接起来使得任意两台电脑都直接或者间 接地相连。</p>
<p>小明发现每台电脑转发、发送或者接受信息需要的时间取决于这台电脑和 多少台电脑直接相连, 而信息在网线中的传播时间可以忽略。比如如果某台电脑 用网线直接连接了另外 �<em>d</em> 台电脑, 那么任何经过这台电脑的信息都会延迟 �<em>d</em> 单 位时间 (发送方和接收方也会产生这样的延迟, 当然如果发送方和接收方都是 同一台电脑就只会产生一次延迟)。</p>
<p>小明一共产生了 �<em>m</em> 个疑问: 如果电脑 ��<em>u**i</em> 向电脑 ��<em>v**i</em> 发送信息, 那么信息从 ��<em>u**i</em> 传到 ��<em>v**i</em> 的最短时间是多少?</p>
<p><strong>解题思路:</strong></p>
<p>还是一道比较明显的求<code>LCA</code>(最近公共祖先)模型的题目,我们可以使用多种方法来解决该问题，这里我们使用更好写的离线的<code>tarjan</code>算法来解决该问题。</p>
<p>除去<code>tarjan</code>算法必用的基础数组，我们还有一个数组<code>d[]</code>,<code>d[i]</code>记录的是每个点的出度，也就是它的延迟时间，以及数组<code>w[]</code>,<code>w[i]</code>的含义是点<code>i</code>到根节点的延迟时间。在通过<code>dfs</code>求出每个点<code>i</code>的<code>w[i]</code>以后，在<code>tarjan</code>中我们该如何求出两点的延迟时间呢？</p>
<p>我们设点<code>i</code>到<code>j</code>的延迟时间为�(�)<em>f</em>(<em>x</em>),当我们求得<code>i</code>与<code>j</code>的最近公共祖先为<code>anc</code>，我们首先让�(�)&#x3D;�[�]+�[�]<em>f</em>(<em>x</em>)&#x3D;<em>w</em>[<em>i</em>]+<em>w</em>[<em>j</em>],但很明显，我们多加了两遍�[���]<em>w</em>[<em>a<strong>n</strong>c</em>]，所以我们需要减去两倍的�[���]<em>w</em>[<em>a<strong>n</strong>c</em>]，但延迟时间还包括经过<code>anc</code>的时间，所以还得加上一个�[���]<em>d</em>[<em>a<strong>n</strong>c</em>]。<strong>此处请结合<code>w[]</code>和<code>d[]</code>的含义理解。</strong> 最后能得出式子:�(�)&#x3D;�[�]+�[ℎ]−�[���]∗2+�[���]<em>f</em>(<em>x</em>)&#x3D;<em>w</em>[<em>i</em>]+<em>w</em>[<em>h</em>]−<em>w</em>[<em>a<strong>n</strong>c</em>]∗2+<em>d</em>[<em>a<strong>n</strong>c</em>]我们利用这个式子在<code>tarjan</code>函数中就能得出每个询问的答案，当然对于起始和结束都在同一个节点的情况下,它的答案就是当前节点的出度，我们可以进行特判一下。输入输出较多，建议使用<code>scanf</code>和<code>printf</code>进行输入输出。</p>
<p><strong>时间复杂度</strong>:<code>dfs</code>：每个点遍历一次,复杂度级别�(�)<em>O</em>(<em>n</em>),<code>tarjan</code>算法复杂度接近 �(�+�)<em>O</em>(<em>n</em>+<em>m</em>)。</p>
<p>C++ 语言描述:</p>
<figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">100010</span>;</span><br><span class="line"></span><br><span class="line">unordered_map&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;&gt; gra;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"><span class="comment">//单个点的出度</span></span><br><span class="line"><span class="type">int</span> d[N];</span><br><span class="line"><span class="comment">//记录点i到根节点的延迟</span></span><br><span class="line"><span class="type">int</span> w[N];</span><br><span class="line"><span class="comment">//并查集数组</span></span><br><span class="line"><span class="type">int</span> q[N];</span><br><span class="line"><span class="comment">//记录答案</span></span><br><span class="line"><span class="type">int</span> res[N];</span><br><span class="line"><span class="type">int</span> st[N];</span><br><span class="line"><span class="comment">//存下查询</span></span><br><span class="line">vector&lt;PII&gt;    query[N];</span><br><span class="line"><span class="comment">//并查集查询</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x!=q[x]) q[x]=<span class="built_in">find</span>(q[x]);</span><br><span class="line">    <span class="keyword">return</span> q[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    w[u]+=d[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> g:gra[u])&#123;</span><br><span class="line">        <span class="keyword">if</span>(g==fa) <span class="keyword">continue</span>;</span><br><span class="line">        w[g]+=w[u];</span><br><span class="line">        <span class="built_in">dfs</span>(g,u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    st[u]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> j:gra[u])&#123;</span><br><span class="line">        <span class="keyword">if</span>(!st[j])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(j);</span><br><span class="line">            q[j]=u;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> item: query[u])&#123;</span><br><span class="line">        <span class="type">int</span> y=item.first,id=item.second;</span><br><span class="line">        <span class="keyword">if</span>(st[y]==<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="type">int</span> anc=<span class="built_in">find</span>(y);</span><br><span class="line">            res[id]=w[y]+w[u]-w[anc]*<span class="number">2</span>+d[anc];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    st[u]=<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;++i)&#123;</span><br><span class="line">        <span class="type">int</span> a,b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">        gra[a].<span class="built_in">push_back</span>(b);</span><br><span class="line">        gra[b].<span class="built_in">push_back</span>(a);</span><br><span class="line">        d[a]++,d[b]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i)&#123;</span><br><span class="line">        <span class="type">int</span> a,b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">        <span class="keyword">if</span>(a!=b)&#123;</span><br><span class="line">            query[a].<span class="built_in">push_back</span>(&#123;b,i&#125;);</span><br><span class="line">            query[b].<span class="built_in">push_back</span>(&#123;a,i&#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res[i]=d[a];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) q[i]=i;</span><br><span class="line">    <span class="built_in">tarjan</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;++i) <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,res[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="hljs highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line">gra = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">d = [<span class="number">0</span>] * <span class="number">100010</span></span><br><span class="line">w = [<span class="number">0</span>] * <span class="number">100010</span></span><br><span class="line">q = [<span class="number">0</span>] * <span class="number">100010</span></span><br><span class="line">res = [<span class="number">0</span>] * <span class="number">100010</span></span><br><span class="line">st = [<span class="number">0</span>] * <span class="number">100010</span></span><br><span class="line">query = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100010</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> x != q[x]:</span><br><span class="line">        q[x] = find(q[x])</span><br><span class="line">    <span class="keyword">return</span> q[x]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">u, fa</span>):</span><br><span class="line">    w[u] += d[u]</span><br><span class="line">    <span class="keyword">for</span> g <span class="keyword">in</span> gra[u]:</span><br><span class="line">        <span class="keyword">if</span> g == fa:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        w[g] += w[u]</span><br><span class="line">        dfs(g, u)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tarjan</span>(<span class="params">u</span>):</span><br><span class="line">    st[u] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> gra[u]:</span><br><span class="line">        <span class="keyword">if</span> st[j] == <span class="number">0</span>:</span><br><span class="line">            tarjan(j)</span><br><span class="line">            q[j] = u</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> query[u]:</span><br><span class="line">        y, <span class="built_in">id</span> = item</span><br><span class="line">        <span class="keyword">if</span> st[y] == <span class="number">2</span>:</span><br><span class="line">            anc = find(y)</span><br><span class="line">            res[<span class="built_in">id</span>] = w[y] + w[u] - w[anc] * <span class="number">2</span> + d[anc]</span><br><span class="line">    st[u] = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">n, m = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">    a, b = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line">    gra[a].append(b)</span><br><span class="line">    gra[b].append(a)</span><br><span class="line">    d[a] += <span class="number">1</span></span><br><span class="line">    d[b] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    a, b = <span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split())</span><br><span class="line">    <span class="keyword">if</span> a != b:</span><br><span class="line">        query[a].append((b, i))</span><br><span class="line">        query[b].append((a, i))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        res[i] = d[a]</span><br><span class="line"></span><br><span class="line">dfs(<span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">    q[i] = i</span><br><span class="line">tarjan(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    <span class="built_in">print</span>(res[i])</span><br></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="hljs highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Pair</span> &#123;</span><br><span class="line">        <span class="type">int</span> first, second;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">(<span class="type">int</span> first, <span class="type">int</span> second)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.first = first;</span><br><span class="line">            <span class="built_in">this</span>.second = second;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Map&lt;Integer, List&lt;Integer&gt;&gt; gra = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] d = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] w = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] q = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span>[] st = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100010</span>];</span><br><span class="line">    <span class="keyword">static</span> List&lt;Pair&gt;[] query = <span class="keyword">new</span> <span class="title class_">List</span>[<span class="number">100010</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">find</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x != q[x]) q[x] = find(q[x]);</span><br><span class="line">        <span class="keyword">return</span> q[x];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> fa)</span> &#123;</span><br><span class="line">        w[u] += d[u];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> g : gra.get(u)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (g == fa) <span class="keyword">continue</span>;</span><br><span class="line">            w[g] += w[u];</span><br><span class="line">            dfs(g, u);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">tarjan</span><span class="params">(<span class="type">int</span> u)</span> &#123;</span><br><span class="line">        st[u] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j : gra.get(u)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (st[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                tarjan(j);</span><br><span class="line">                q[j] = u;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Pair item : query[u]) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> item.first, id = item.second;</span><br><span class="line">            <span class="keyword">if</span> (st[y] == <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">anc</span> <span class="operator">=</span> find(y);</span><br><span class="line">                res[id] = w[y] + w[u] - w[anc] * <span class="number">2</span> + d[anc];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        st[u] = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            gra.put(i, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">            query[i] = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">            <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">            gra.get(a).add(b);</span><br><span class="line">            gra.get(b).add(a);</span><br><span class="line">            d[a]++;</span><br><span class="line">            d[b]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">            <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">            <span class="keyword">if</span> (a != b) &#123;</span><br><span class="line">                query[a].add(<span class="keyword">new</span> <span class="title class_">Pair</span>(b, i));</span><br><span class="line">                query[b].add(<span class="keyword">new</span> <span class="title class_">Pair</span>(a, i));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                res[i] = d[a];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(<span class="number">1</span>, -<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">           q[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        tarjan(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            System.out.println(res[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="环境治理"><a href="#环境治理" class="headerlink" title="环境治理"></a>环境治理</h2><p>LQ 国拥有 �<em>n</em> 个城市, 从 0 到 �−1<em>n</em>−1 编号, 这 �<em>n</em> 个城市两两之间都有且仅有 一条双向道路连接, 这意味着任意两个城市之间都是可达的。每条道路都有一 个属性 �<em>D</em>, 表示这条道路的灰尘度。当从一个城市 �<em>A</em> 前往另一个城市 �<em>B</em> 时, 可 能存在多条路线, 每条路线的灰尘度定义为这条路线所经过的所有道路的灰尘 度之和, LQ 国的人都很讨厌灰尘, 所以他们总会优先选择灰尘度最小的路线。</p>
<p>LQ 国很看重居民的出行环境, 他们用一个指标 �<em>P</em> 来衡量 LQ 国的出行环 境, �<em>P</em> 定义为:</p>
<p>�&#x3D;∑∗�&#x3D;0�−1∑∗�&#x3D;0�−1�(�,�)<em>P</em>&#x3D;∑∗<em>i</em>&#x3D;0<em>n</em>−1∑∗<em>j</em>&#x3D;0<em>n</em>−1<em>d</em>(<em>i</em>,<em>j</em>)</p>
<p>其中 �(�,�)<em>d</em>(<em>i</em>,<em>j</em>) 表示城市 �<em>i</em> 到城市 �<em>j</em> 之间灰尘度最小的路线对应的灰尘度的值。 为了改善出行环境, 每个城市都要有所作为, 当某个城市进行道路改善时, 会将与这个城市直接相连的所有道路的灰尘度都减少 1 , 但每条道路都有一个 灰尘度的下限值 �<em>L</em>, 当灰尘度达到道路的下限值时, 无论再怎么改善, 道路的 灰尘度也不会再减小了。</p>
<p>具体的计划是这样的:</p>
<p>第 1 天, 0 号城市对与其直接相连的道路环境进行改善;</p>
<p>第 2 天, 1 号城市对与其直接相连的道路环境进行改善;</p>
<p>⋯⋯</p>
<p>第 �<em>n</em> 天, �−1<em>n</em>−1 号城市对与其直接相连的道路环境进行改善;</p>
<p>第 �+1<em>n</em>+1 天, 0 号城市对与其直接相连的道路环境进行改善;</p>
<p>第 �+2<em>n</em>+2 天, 1 号城市对与其直接相连的道路环境进行改善;</p>
<p>LQ 国想要使得 �<em>P</em> 指标满足 �≤�<em>P</em>≤<em>Q</em> 。请问最少要经过多少天之后, �<em>P</em> 指标 可以满足 �≤�<em>P</em>≤<em>Q</em> 。如果在初始时就已经满足条件, 则输出 0 ; 如果永远不可能 满足, 则输出 −1−1 。</p>
<p><strong>解题思路:</strong></p>
<p>首先，对于求解<code>P</code>指的公式，我们要清楚，是每个点到其他所有点的最短路径之和相加，这种涉及到任意两点的最短路，加上 �<em>n</em> 的最大范围只有<code>100</code>，很明显我们需要想到<code>Floyd</code>算法求任意两点的最短路。</p>
<p>我们并没有一个直观的算法直接求得答案，所以，我们考虑<strong>二分答案。</strong> 如果改善<code>x</code>天是符合要求的，那么大于<code>x</code>的天数也一定符合，但小于<code>x</code>的天数不一定，所以满足二段性，我们可以二分。</p>
<p>我们用<code>g[][]</code>记录初始道路的灰尘度,<code>m[][]</code>记录每条道路的最低灰尘度,<code>f[][]</code>记录的是在改善<code>x</code>天后的每条道路的环境。这样我们就可以使用二分+<code>Floyd</code>的做法得到答案。</p>
<p>当然这里有一些需要注意的细节问题，当我们改变<code>f[i][j]</code>的值时，相应的也要改变<code>f[j][i]</code>的值，因为任意两点只存在一条双向道路，所以这两个状态应该表示的是同一条道路。每次<code>check</code>时，别忘记将<code>f[][]</code>重置回<code>g[][]</code>，再去减去对于的天数。<code>floyd</code>函数每次跑完后，计算并返回此时的<code>P</code>值。</p>
<p>最开始时我们可以判断每条道路都是最低复杂度的情况下，计算出来的<code>P</code>是否大于<code>Q</code>，如果大于说明肯定无解，直接返回<code>-1</code>即可。二分对于<code>r</code>的上限也需要注意，最多<code>100</code>个点，每个点最大<code>1e5</code>，所以理论上我们只要开到大于<code>1e7</code>以上就不会有问题，否则样例过大时可能会出错。</p>
<p>时间复杂度：�(�3���(�∗�))<em>O</em>(<em>n</em>3<em>l<strong>o</strong>g</em>(<em>n</em>∗<em>m</em>))。</p>
<p>C++ 语言描述:</p>
<figure class="hljs highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">110</span>;</span><br><span class="line"></span><br><span class="line">LL g[N][N];</span><br><span class="line">LL m[N][N];</span><br><span class="line">LL f[N][N];</span><br><span class="line">LL n,q;</span><br><span class="line"><span class="function">LL <span class="title">floyd</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL a=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; k ++ )</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++ )</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j ++ )</span><br><span class="line">                f[i][j] = <span class="built_in">min</span>(f[i][j], f[i][k] + f[k][j]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">            a+=f[i][j];</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//改善X天</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memcpy</span>(f,g,<span class="built_in">sizeof</span>(g));</span><br><span class="line">    LL h=x/n;</span><br><span class="line">    LL s=x%n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i==j) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(i&lt;=s) f[i][j]=<span class="built_in">max</span>(m[i][j],f[i][j]-h<span class="number">-1</span>);</span><br><span class="line">            <span class="keyword">else</span> f[i][j]=<span class="built_in">max</span>(m[i][j],f[i][j]-h);</span><br><span class="line">            f[j][i]=f[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">floyd</span>()&lt;=q;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">            cin&gt;&gt;g[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">            cin&gt;&gt;m[i][j];</span><br><span class="line">            f[i][j]=m[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">floyd</span>()&gt;q)&#123;</span><br><span class="line">        cout&lt;&lt;<span class="number">-1</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    LL l=<span class="number">0</span>,r=<span class="number">1000000000</span>;</span><br><span class="line">    <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">        <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">check</span>(mid)) r=mid;</span><br><span class="line">        <span class="keyword">else</span> l=mid+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;r&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Python 语言描述:</p>
<figure class="hljs highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line">N=<span class="number">110</span></span><br><span class="line">g=[[<span class="number">0</span>]*N <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">m=[[<span class="number">0</span>]*N <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">f=[[<span class="number">0</span>]*N <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">n,q=<span class="built_in">map</span>(<span class="built_in">int</span>,<span class="built_in">input</span>().split())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">floyd</span>(<span class="params">f</span>):</span><br><span class="line">    a=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">                f[i][j]=<span class="built_in">min</span>(f[i][j],f[i][k]+f[k][j])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">            a=a+f[i][j]</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">x,g</span>):</span><br><span class="line">    f=copy.deepcopy(g)</span><br><span class="line">    h=x//n</span><br><span class="line">    s=x%n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> i==j:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> i&lt;=s:</span><br><span class="line">                f[i][j]=<span class="built_in">max</span>(m[i][j],f[i][j]-h-<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                f[i][j]=<span class="built_in">max</span>(m[i][j],f[i][j]-h)</span><br><span class="line">            f[j][i]=f[i][j]</span><br><span class="line">    <span class="keyword">return</span>  floyd(f)&lt;=q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">        l=<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,<span class="built_in">input</span>().split()))</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">            g[i][j]=l[j-<span class="number">1</span>]<span class="comment">#灰尘度</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">        l = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, <span class="built_in">input</span>().split()))</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">            m[i][j]=l[j-<span class="number">1</span>]<span class="comment">#灰尘度的下限值</span></span><br><span class="line">            f[i][j]=m[i][j]</span><br><span class="line">    <span class="keyword">if</span> floyd(f)&gt;q:</span><br><span class="line">        <span class="built_in">print</span>(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    l,r=<span class="number">0</span>,<span class="number">10000000</span></span><br><span class="line">    <span class="keyword">while</span> (l &lt; r):</span><br><span class="line">        mid=(l+r)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (check(mid,g)):</span><br><span class="line">            r=mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l=mid+<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(r)</span><br><span class="line">solve()</span><br></pre></td></tr></table></figure>

<p>Java 语言描述:</p>
<figure class="hljs highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> N=<span class="number">110</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span>[][] g=<span class="keyword">new</span> <span class="title class_">long</span>[N][N],m=<span class="keyword">new</span> <span class="title class_">long</span>[N][N],f=<span class="keyword">new</span> <span class="title class_">long</span>[N][N];</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span> n,q;</span><br><span class="line">    <span class="keyword">static</span> BufferedReader br=<span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(System.in));</span><br><span class="line">    <span class="keyword">static</span> PrintWriter  out=<span class="keyword">new</span> <span class="title class_">PrintWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(System.out));</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        String[] s=br.readLine().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        n=Long.parseLong(s[<span class="number">0</span>]);</span><br><span class="line">        q=Long.parseLong(s[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">            s=br.readLine().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">                g[i][j]=Long.parseLong(s[j-<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">            s=br.readLine().split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">                m[i][j]=Long.parseLong(s[j-<span class="number">1</span>]);</span><br><span class="line">                f[i][j]=m[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(floyd()&gt;q)&#123;</span><br><span class="line">            out.println(-<span class="number">1</span>);</span><br><span class="line">            out.flush();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> l=<span class="number">0</span>,r=<span class="number">1000000000</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">            <span class="type">long</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(check(mid)) r=mid;</span><br><span class="line">            <span class="keyword">else</span> l=mid+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        out.println(r);</span><br><span class="line">        out.flush();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">long</span> <span class="title function_">floyd</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">long</span> a=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">1</span>; k &lt;= n; k ++ )</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i ++ )</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= n; j ++ )</span><br><span class="line">                    f[i][j] =Math.min(f[i][j], f[i][k] + f[k][j]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">                a+=f[i][j];</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(<span class="type">long</span> x)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j) f[i][j]=g[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> h=x/n;</span><br><span class="line">        <span class="type">long</span> s=x%n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;++j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i==j) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span>(i&lt;=s) f[i][j]=Math.max(m[i][j],f[i][j]-h-<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">else</span> f[i][j]=Math.max(m[i][j],f[i][j]-h);</span><br><span class="line">                f[j][i]=f[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> floyd()&lt;=q;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </main>
    <footer class="post-footer">
      
      <div class="post-tags">
        
        <a class="post-tag button" href="/tags/%E8%93%9D%E6%A1%A5%E6%9D%AF%E5%A4%87%E8%B5%9B/" rel="tag"><i class="fas fa-tags"></i>蓝桥杯备赛</a>
        
      </div>
      
    </footer>
  </article>
  
  
  <nav class="page-nav">
    <div class="page-nav-next page-nav-item">
      
      <a href="/2024/02/22/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" rel="next" title="动态规划"><i class="fas fa-angle-left"></i><span class="nav-title">动态规划</span></a>
      
    </div>
    <div class="page-nav-prev page-nav-item">
      
      <a href="/2024/02/22/%E7%AE%80%E5%8D%95%E6%95%B0%E8%AE%BA/" rel="prev" title="简单数论"><span class="nav-title">简单数论</span><i class="fas fa-angle-right"></i></a>
      
    </div>
  </nav>
  
  
</div>

          </div>
          
          
          
<aside class="sidebar" id="sidebar" style="background: url(/images/background.png);">
  
  <div class="search">
    <div class="form-group">
      <i class="fas fa-search"></i><input type="search" id="search-input" name="q" results="0" placeholder="搜索" class="form-control"/>
    </div>
  </div>
  <div class="search-result-box" id="search-result"></div>
  
  
<div class="info sidebar-item" id="info">
  
  <img class="author-avatar" src="/images/avatar.png" alt="zdx">
  
  <h1 class="author-name">zdx</h1>
  <h2 class="author-description"></h2>
  <div class="site-count">
    
    
    
    
    
    
    
    
    
    
    
  </div>
  
  <div class="rss">
    <a class="rss-link button sidebar-item" href="/atom.xml"><i class="fas fa-rss"></i>RSS</a>
  </div>
  
</div>


  <div class="sidebar-sticky">
    
    
    
    
    
    <hr>
    <div class="post-toc sidebar-item" id="toc-div">
      <div><i class="fas fa-list-ol"></i>文章目录</div>
      <div class="post-toc-content"><ol class="list-group toc"><li class="toc-item toc-level-1"><a class="list-group-item toc-link" href="#%E5%9B%BE%E8%AE%BA"><span class="toc-text">图论</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E5%9B%BE%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">图的基本概念</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#%E5%9B%BE%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="toc-text">图的种类</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#%E5%9B%BE%E7%AE%97%E6%B3%95%E7%9A%84%E6%97%B6%E9%97%B4%E5%88%86%E6%9E%90"><span class="toc-text">图算法的时间分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E5%9B%BE%E7%9A%84%E5%AD%98%E5%82%A8"><span class="toc-text">图的存储</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#%E6%95%B0%E7%BB%84%E5%AD%98%E8%BE%B9"><span class="toc-text">数组存边</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#%E9%82%BB%E6%8E%A5%E7%9F%A9%E9%98%B5"><span class="toc-text">邻接矩阵</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#%E9%82%BB%E6%8E%A5%E8%A1%A8%E5%92%8C%E9%93%BE%E5%BC%8F%E5%89%8D%E5%90%91%E6%98%9F"><span class="toc-text">邻接表和链式前向星</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E6%9C%80%E7%9F%AD%E8%B7%AF%E9%97%AE%E9%A2%98"><span class="toc-text">最短路问题</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#%E6%9C%80%E7%9F%AD%E8%B7%AF%E7%AE%97%E6%B3%95%E6%AF%94%E8%BE%83"><span class="toc-text">最短路算法比较</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#Floyd-%E7%AE%97%E6%B3%95"><span class="toc-text">Floyd 算法</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-4"><a class="list-group-item toc-link" href="#Floyd-%E7%AE%97%E6%B3%95%E6%80%9D%E6%83%B3%EF%BC%9A%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92"><span class="toc-text">Floyd 算法思想：动态规划</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#Dijkstra-%E7%AE%97%E6%B3%95"><span class="toc-text">Dijkstra 算法</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-4"><a class="list-group-item toc-link" href="#%E7%AE%97%E6%B3%95%E6%80%9D%E6%83%B3"><span class="toc-text">算法思想</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#Bellman-Ford-%E7%AE%97%E6%B3%95"><span class="toc-text">Bellman-Ford 算法</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-4"><a class="list-group-item toc-link" href="#SPFA-%E7%AE%97%E6%B3%95"><span class="toc-text">SPFA 算法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91"><span class="toc-text">最小生成树</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#Prim-%E7%AE%97%E6%B3%95"><span class="toc-text">Prim 算法</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#kruskal-%E7%AE%97%E6%B3%95"><span class="toc-text">kruskal 算法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="list-group-item toc-link" href="#%E5%9B%BE%E8%AE%BA%E4%BE%8B%E9%A2%98"><span class="toc-text">图论例题</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E8%93%9D%E6%A1%A5%E7%8E%8B%E5%9B%BD-lanqiaoOJ-%E9%A2%98%E5%8F%B7-1122"><span class="toc-text">蓝桥王国 lanqiaoOJ 题号 1122</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%8D%AE%E4%B8%8B%E7%9A%84%E6%9C%80%E7%9F%AD%E8%B7%AF%E9%97%AE%E9%A2%98-lanqiaoOJ-%E9%A2%98%E5%8F%B7-1366"><span class="toc-text">随机数据下的最短路问题 lanqiaoOJ 题号 1366</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E8%B7%AF%E5%BE%84-OJ-%E7%BC%96%E5%8F%B7-1460"><span class="toc-text">路径 OJ 编号 1460</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E5%87%BA%E5%B7%AE"><span class="toc-text">出差</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E8%81%AA%E6%98%8E%E7%9A%84%E7%8C%B4%E5%AD%90"><span class="toc-text">聪明的猴子</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E9%80%9A%E7%94%B5"><span class="toc-text">通电</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E6%9C%BA%E6%88%BF"><span class="toc-text">机房</span></a></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#%E7%8E%AF%E5%A2%83%E6%B2%BB%E7%90%86"><span class="toc-text">环境治理</span></a></li></ol></li></ol></div>
    </div>
    
    
    
    <hr>
    <div class="social-link sidebar-item">
      <div><i class="far fa-address-card"></i>社交链接</p></div>
      <ul>
        
        <li><i class="fas fa-envelope"></i><a href="mailto:youremail@youremailhost" target="_blank">E-Mail</a></li>
        
        <li><i class="fab fa-github"></i><a href="https://github.com/" target="_blank">GitHub</a></li>
        
        <li><i class="fab fa-weibo"></i><a href="https://weibo.com/" target="_blank">Weibo</a></li>
        
      </ul>
    </div>
    
    
    <hr>
    <div class="blogroll sidebar-item">
      <div><i class="fas fa-link"></i>友情链接</div>
      <ul>
        
        <li><i class="fas fa-link"></i><a href="https://github.com/" target="_blank">GitHub</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://developer.mozilla.org/" target="_blank">MDN</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://mozilla.github.io/nunjucks/" target="_blank">Nunjucks</a></li>
        
      </ul>
    </div>
    
  </div>
</aside>


          
        </div>
      </div>
    </main>
    
<footer id="footer" class="footer" style="background: #33363b;">
  <div class="container">
    <div class="back-to-top">
      <button id="back-to-top"><i class="fas fa-angle-double-up" aria-label="回到顶部"></i></button>
    </div>
    <div class="footer-container">
      <div class="footer-left">
        <div class="copyright">
          <span class="author">zdx</span><span class="year"><i class="far fa-copyright"></i>2024</span>
        </div>
        
        <div class="busuanzi">
          <span id="busuanzi_container_site_pv"><i class="fas fa-eye" aria-label="站点点击量" aria-hidden="false"></i><span id="busuanzi_value_site_pv"></span></span><span id="busuanzi_container_site_uv"><i class="fas fa-user" aria-label="站点用户数" aria-hidden="false"></i><span id="busuanzi_value_site_uv"></span></span><span id="busuanzi_container_page_pv"><i class="far fa-file-alt"></i><span id="busuanzi_value_page_pv" aria-label="页面点击量" aria-hidden="false"></span></span>
        </div>
        
      </div>
      <div class="footer-right">
        <div class="custom-info">
          
          托管于<i class="fab fa-github-alt"></i><a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
          
        </div>
        <div class="powered-by">
          由 <a href="https://hexo.io/" target="_blank">Hexo</a> 强力驱动 | 主题 <a href="https://github.com/AlynxZhou/hexo-theme-aria/" target="_blank">ARIA</a>
        </div>
      </div>
    </div>
  </div>
</footer>


  </body>
</html>
